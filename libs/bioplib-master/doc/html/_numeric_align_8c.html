<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Bioplib: /serv/www/html_lilian/bioplib-master/src/NumericAlign.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bioplib
   </div>
   <div id="projectbrief">Protein Structure C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">NumericAlign.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Perform Needleman &amp; Wunsch sequence alignment on two sequences encoded as numeric symbols.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_sys_defs_8h_source.html">SysDefs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="array_8h_source.html">array.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="general_8h_source.html">general.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="seq_8h_source.html">seq.h</a>&quot;</code><br/>
</div>
<p><a href="_numeric_align_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_x_y.html">XY</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a182088d18407b75db67d5185b9ac0bfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_numeric_align_8c.html#a182088d18407b75db67d5185b9ac0bfa">DATAENV</a>&#160;&#160;&#160;&quot;DATADIR&quot;   /* Environment variable or assign           */</td></tr>
<tr class="separator:a182088d18407b75db67d5185b9ac0bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_numeric_align_8c.html#a0c8dad16ba61ded55d3f302a616c0ced">MAXBUFF</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af3438f88a5286d057de168f03e146703"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_numeric_align_8c.html#af3438f88a5286d057de168f03e146703">blNumericReadMDM</a> (char *mdmfile)</td></tr>
<tr class="separator:af3438f88a5286d057de168f03e146703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca4dc7d7e7714971036f5d1e22ccce6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_numeric_align_8c.html#a4ca4dc7d7e7714971036f5d1e22ccce6">blNumericCalcMDMScore</a> (int resa, int resb)</td></tr>
<tr class="separator:a4ca4dc7d7e7714971036f5d1e22ccce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65436ca35c20f5c0dca48c3ead12b816"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_numeric_align_8c.html#a65436ca35c20f5c0dca48c3ead12b816">blNumericAffineAlign</a> (int *seq1, int length1, int *seq2, int length2, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> verbose, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> identity, int penalty, int penext, int *align1, int *align2, int *align_len)</td></tr>
<tr class="separator:a65436ca35c20f5c0dca48c3ead12b816"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Perform Needleman &amp; Wunsch sequence alignment on two sequences encoded as numeric symbols. </p>
<dl class="section version"><dt>Version</dt><dd>V1.3 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>07.07.14 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) UCL / Dr. Andrew C. R. Martin / University of Reading 1993-2014 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dr. Andrew C. R. Martin </dd></dl>
<dl class="section user"><dt></dt><dd>Institute of Structural &amp; Molecular Biology, University College London, Gower Street, London. WC1E 6BT. </dd></dl>
<dl class="section user"><dt></dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w@b'+'io'+'inf'+'.o'+'rg.'+'uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w@bi<span style="display: none;">.nosp@m.</span>oinf.<span style="display: none;">.nosp@m.</span>org.<span style="display: none;">.nosp@m.</span>uk</a> <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w.m'+'ar'+'tin'+'@u'+'cl.'+'ac'+'.uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w.ma<span style="display: none;">.nosp@m.</span>rtin@<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a></dd></dl>
<p>This code is NOT IN THE PUBLIC DOMAIN, but it may be copied according to the conditions laid out in the accompanying file COPYING.DOC.</p>
<p>The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.</p>
<p>The code may not be sold commercially or included as part of a commercial product except as described in the file COPYING.DOC.</p>
<p>Note, the code herein is very heavily based on code written by Dr. Andrew C.R. Martin while self-employed. Some modifications were made to that original code while employed at University College London. This version which handles sequences encoded as arrays of numbers rather than as character arrays was modified from the original version(s) while employed at Reading University.</p>
<h1>Description: </h1>
<p>A simple Needleman &amp; Wunsch Dynamic Programming alignment of 2 sequences encoded as numeric symbols. A window is not used so the routine may be a bit slow on long sequences.</p>
<h1>Usage: </h1>
<p>First call NumericReadMDM() to read the mutation data matrix, then call NumericAffineAlign() to align the sequences.</p>
<h1>Revision History: </h1>
<ul>
<li>V1.0 08.03.00 A modified version of <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a> V2.12 written by ACRM from 19.06.90 to 06.03.00</li>
<li>V1.1 28.09.00 Fixed bug at end of alignment if one sequence finishes first</li>
<li>V1.2 06.02.03 Fixed for new version of GetWord()</li>
<li>V1.3 07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition in file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a182088d18407b75db67d5185b9ac0bfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATAENV&#160;&#160;&#160;&quot;DATADIR&quot;   /* Environment variable or assign           */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_numeric_align_8c_source.html#l00110">110</a> of file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0c8dad16ba61ded55d3f302a616c0ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXBUFF&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_numeric_align_8c_source.html#l00112">112</a> of file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a65436ca35c20f5c0dca48c3ead12b816"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int blNumericAffineAlign </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>seq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>seq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>penext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>align1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>align2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>align_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*seq1</td><td>First sequence of tokens </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length1</td><td>First sequence length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*seq2</td><td>Second sequence of tokens </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length2</td><td>Second sequence length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>Display N&amp;W matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">identity</td><td>Use identity matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">penalty</td><td>Gap insertion penalty value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">penext</td><td>Extension penalty </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*align1</td><td>Sequence 1 aligned </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*align2</td><td>Sequence 2 aligned </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*align_len</td><td>Alignment length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Alignment score (0 on error)</dd></dl>
<p>Perform simple N&amp;W alignment of seq1 and seq2. No window is used, so will be slow for long sequences.</p>
<p>The sequences come as integer arrays containing numeric tokens</p>
<p>Note that you must allocate sufficient memory for the aligned sequences. The easy way to do this is to ensure that align1 and align2 are of length (length1+length2).</p>
<p>Identical to <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/affinealign(), but uses integer arrays</p>
<ul>
<li>08.03.00 Original based on <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/affinealign() 06.03.00 By: ACRM</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_numeric_align_8c_source.html#l00412">412</a> of file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4ca4dc7d7e7714971036f5d1e22ccce6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int blNumericCalcMDMScore </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>resa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>resb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">resa</td><td>First token </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resb</td><td>Second token </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score</dd></dl>
<p>Calculate score from static globally stored mutation data matrix</p>
<p>Identical to <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/CalcMDMScore(), but uses a different static score array and takes integer parameters. These are used as direct lookups into the score array rather than being searched.</p>
<ul>
<li>08.03.00 Original based on <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/CalcMDMScore() 11.07.96 By: ACRM</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_numeric_align_8c_source.html#l00342">342</a> of file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>

</div>
</div>
<a class="anchor" id="af3438f88a5286d057de168f03e146703"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blNumericReadMDM </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mdmfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*mdmfile</td><td>Mutation data matrix filename </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Success?</dd></dl>
<p>Read mutation data matrix into static global arrays. The matrix may have comments at the start introduced with a ! in the first column. The matrix must be complete (i.e. a triangular matrix will not work). A line describing the residue types must appear, and may be placed before or after the matrix itself</p>
<p>Identical to <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/ReadMDM() but reads into a different static 2D array and doesn't read a symbol identifier line from the file as the symbols are numeric and always start from 1 (0 is used as the insert character)</p>
<ul>
<li>08.03.00 Original based on <a class="el" href="align_8c.html" title="Perform Needleman &amp; Wunsch sequence alignment. ">align.c</a>/ReadMDM() 26.07.95 By: ACRM</li>
<li>06.02.03 Fixed for new version of GetWord()</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_numeric_align_8c_source.html#l00258">258</a> of file <a class="el" href="_numeric_align_8c_source.html">NumericAlign.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 06:58:46 for Bioplib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
