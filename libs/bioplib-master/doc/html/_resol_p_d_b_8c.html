<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Bioplib: /serv/www/html_lilian/bioplib-master/src/ResolPDB.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bioplib
   </div>
   <div id="projectbrief">Protein Structure C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ResolPDB.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Get resolution and R-factor information out of a PDB file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="pdb_8h_source.html">pdb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
</div>
<p><a href="_resol_p_d_b_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a0c8dad16ba61ded55d3f302a616c0ced">MAXBUFF</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a35c8f98e52940966707d8004ed8a5826"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a35c8f98e52940966707d8004ed8a5826">blGetResolPDB</a> (FILE *fp, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *resolution, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *RFactor, int *StrucType)</td></tr>
<tr class="separator:a35c8f98e52940966707d8004ed8a5826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d5b4d6154f9efed0b1bf00dcb5aa16b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a4d5b4d6154f9efed0b1bf00dcb5aa16b">blGetResolWholePDB</a> (<a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *wpdb, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *resolution, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *RFactor, int *StrucType)</td></tr>
<tr class="separator:a4d5b4d6154f9efed0b1bf00dcb5aa16b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f6538fb3e9116b484a44993c62a1a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a80f6538fb3e9116b484a44993c62a1a6">blGetExptlPDB</a> (FILE *fp, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *resolution, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *RFactor, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *FreeR, int *StrucType)</td></tr>
<tr class="separator:a80f6538fb3e9116b484a44993c62a1a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae30274ef986cfdd010792451a61ae96b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#ae30274ef986cfdd010792451a61ae96b">blGetExptlWholePDB</a> (<a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *wpdb, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *resolution, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *RFactor, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *FreeR, int *StrucType)</td></tr>
<tr class="separator:ae30274ef986cfdd010792451a61ae96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570868c653dcba07ecddf06b1a15c4b2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a570868c653dcba07ecddf06b1a15c4b2">blReportStructureType</a> (int StrucType)</td></tr>
<tr class="separator:a570868c653dcba07ecddf06b1a15c4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09f6999081df2204ee322f785319282e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_resol_p_d_b_8c.html#a09f6999081df2204ee322f785319282e">blGetExptlOld</a> (FILE *fp, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *resolution, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *RFactor, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *FreeR, int *StrucType)</td></tr>
<tr class="separator:a09f6999081df2204ee322f785319282e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Get resolution and R-factor information out of a PDB file. </p>
<dl class="section version"><dt>Version</dt><dd>V1.8 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>07.07.14 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) UCL / Dr. Andrew C.R. Martin, 1994-2014 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dr. Andrew C. R. Martin </dd></dl>
<dl class="section user"><dt></dt><dd>Institute of Structural &amp; Molecular Biology, University College London, Gower Street, London. WC1E 6BT. </dd></dl>
<dl class="section user"><dt></dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w@b'+'io'+'inf'+'.o'+'rg.'+'uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w@bi<span style="display: none;">.nosp@m.</span>oinf.<span style="display: none;">.nosp@m.</span>org.<span style="display: none;">.nosp@m.</span>uk</a> <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w.m'+'ar'+'tin'+'@u'+'cl.'+'ac'+'.uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w.ma<span style="display: none;">.nosp@m.</span>rtin@<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a></dd></dl>
<p>This code is NOT IN THE PUBLIC DOMAIN, but it may be copied according to the conditions laid out in the accompanying file COPYING.DOC.</p>
<p>The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.</p>
<p>The code may not be sold commercially or included as part of a commercial product except as described in the file COPYING.DOC.</p>
<h1>Description: </h1>
<h1>Usage: </h1>
<p>See documentation for details</p>
<h1>Revision History: </h1>
<ul>
<li>V1.0 28.02.94 Original</li>
<li>V1.1 18.03.94 Removed extraneous printf() statement</li>
<li>V1.2 17.07.96 Added check for EXPERIMENT TYPE : THEORETICAL MODEL Fixed bug in searching for MODEL or NMR info</li>
<li>V1.3 27.06.97 Added handing of RESOLUTION records which point you to another record for the experiment type. Fixed EXPERIMENT TYPE to look for NMR as well Looks for EXPDTA NMR record</li>
<li>V1.4 23.03.98 Added check that RESOLUTION record is in a REMARK 2</li>
<li>V1.5 08.02.99 GetResolPDB() now a wrapper to GetExptl() which now parses structured REMARK3 blocks and also returns the Free R. Initialise some variables to 0.0</li>
<li>V1.6 30.05.02 Incorporated changes from Inpharmatica - now finds Electron diffraction as an experimental type. Handles files without REMARK 2 correctly</li>
<li>V1.7 13.12.12 Complete re-implementation of GetExptl() for remediated PDB files. Old version for old PDB files available as GetExptlOld()</li>
<li>V1.8 07.07.14 Use bl prefix for functions By: CTP</li>
<li>V1.9 02.03.15 Renamed blGetExptl() to <a class="el" href="pdb_8h.html#a80f6538fb3e9116b484a44993c62a1a6">blGetExptlPDB()</a> Moved ReadData() out from <a class="el" href="pdb_8h.html#a80f6538fb3e9116b484a44993c62a1a6">blGetExptlPDB()</a> Added <a class="el" href="pdb_8h.html#ae30274ef986cfdd010792451a61ae96b">blGetExptlWholePDB()</a> </li>
</ul>

<p>Definition in file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a0c8dad16ba61ded55d3f302a616c0ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXBUFF&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00121">121</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a09f6999081df2204ee322f785319282e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blGetExptlOld </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>RFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>FreeR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>StrucType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>PDB file pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*resolution</td><td>The resolution (0.0 if not applicable) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*RFactor</td><td>The R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*FreeR</td><td>The Free R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*StrucType</td><td>Structure type: STRUCTURE_TYPE_XTAL STRUCTURE_TYPE_NMR STRUCTURE_TYPE_MODEL STRUCTURE_TYPE_UNKNOWN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if resolution found (even if not applicable)</dd></dl>
<p>This routine attempts to obtain resolution and R-factor information out of a PDB file. It returns TRUE or FALSE to indicate whether valid information was found. Resolution-not-applicable structures then have the resolution set to zero.</p>
<p>N.B. The resolution information returned by the routine is reliable; the R-factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-factor to be the first number after the words `R-value' (or one of the other keys - see the case statement in the code for the valid keywords). Thus we cannot handle records of the form: THE R-VALUE FOR 7142 REFLECTIONS BETWEEN 10.0 AND 1.97 ANGSTROMS REFINEMENT CYCLE 73 IS 0.254. as appears in entries such as 1LZT. Here, the first number is the number of reflections. There is thus a kludge which sets the R-factor to zero if it was read as greater than 0.5 to avoid this situation. In these cases, we lose the R-factor information. This occurs in approx 3.5% of the 1XXX PDB entries.</p>
<ul>
<li>25.02.94 Original By: ACRM</li>
<li>28.02.94 Added " R = " and check that VALUE wasn't B-VALUE</li>
<li>17.07.96 Added check for EXPERIMENT TYPE : THEORETICAL MODEL Also fixed bug in searching REMARK record</li>
<li>27.06.97 Added handing of RESOLUTION records which point you to another record for the experiment type. Fixed some calls to FindNextNumber() which were checking an 80 character width Fixed EXPERIMENT TYPE to look for NMR as well Looks for EXPDTA NMR record</li>
<li>23.03.98 Added check that RESOLUTION record is in a REMARK 2</li>
<li>08.03.99 Renamed to GetExptl() from GetResolPDB() and added FreeR parameter. GetResolPDB() is now a wrapper to this routine. Added additional pass which looks for the structured REMARK 3 records</li>
<li>28.04.99 Initialise FindRefRecord et al. to zero</li>
<li>18.06.99 Added other strings to the valid structured block for pass 0 Added check for -ve R-factor</li>
<li>08.09.99 Now takes the first FREE R-factor followed by 17 spaces rather than the last</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00666">666</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a80f6538fb3e9116b484a44993c62a1a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blGetExptlPDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>RFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>FreeR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>StrucType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>PDB file pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*resolution</td><td>The resolution (0.0 if not applicable) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*RFactor</td><td>The R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*FreeR</td><td>The Free R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*StrucType</td><td>Structure type: STRUCTURE_TYPE_XTAL STRUCTURE_TYPE_NMR STRUCTURE_TYPE_MODEL STRUCTURE_TYPE_UNKNOWN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if resolution found or valid structure type found</dd></dl>
<p>This routine attempts to obtain resolution and R-factor information out of a PDB file. It returns TRUE or FALSE to indicate whether valid information was found. Resolution-not-applicable structures then have the resolution set to zero.</p>
<ul>
<li>12.12.11 Original By: ACRM New implementation for remediated PDB files. The old version is available as GetExptlOld() which handles old format files. NOTE If multiple methods specified in EXPDTA record, only the first is used If multiple R-factors are provided in different sections, then the first one is returned.</li>
<li>07.07.14 Use bl prefix for functions By: CTP</li>
<li>02.03.15 Moved the actual work into ReadData() By: ACRM Renamed from blGetExptl() </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00289">289</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae30274ef986cfdd010792451a61ae96b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blGetExptlWholePDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td>
          <td class="paramname"><em>wpdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>RFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>FreeR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>StrucType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*wpdb</td><td>WHOLEPDB structure pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*resolution</td><td>The resolution (0.0 if not applicable) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*RFactor</td><td>The R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*FreeR</td><td>The Free R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*StrucType</td><td>Structure type: STRUCTURE_TYPE_XTAL STRUCTURE_TYPE_NMR STRUCTURE_TYPE_MODEL STRUCTURE_TYPE_UNKNOWN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if resolution found or valid structure type found</dd></dl>
<p>This routine attempts to obtain resolution and R-factor information out of a PDB file. It returns TRUE or FALSE to indicate whether valid information was found. Resolution-not-applicable structures then have the resolution set to zero.</p>
<ul>
<li>02.03.15 Original based on <a class="el" href="pdb_8h.html#a80f6538fb3e9116b484a44993c62a1a6">blGetExptlPDB()</a> By: ACRM </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00350">350</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a35c8f98e52940966707d8004ed8a5826"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blGetResolPDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>RFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>StrucType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>PDB file pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*resolution</td><td>The resolution (0.0 if not applicable) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*RFactor</td><td>The R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*StrucType</td><td>Structure type: STRUCTURE_TYPE_XTAL STRUCTURE_TYPE_NMR STRUCTURE_TYPE_MODEL STRUCTURE_TYPE_UNKNOWN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if resolution found (even if not applicable)</dd></dl>
<p>This routine attempts to obtain resolution and R-factor information out of a PDB file. It returns TRUE or FALSE to indicate whether valid information was found. Resolution-not-applicable structures then have the resolution set to zero.</p>
<p>N.B. The resolution information returned by the routine is reliable; the R-factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-factor to be the first number after the words `R-value' (or one of the other keys - see the case statement in the code for the valid keywords). Thus we cannot handle records of the form: THE R-VALUE FOR 7142 REFLECTIONS BETWEEN 10.0 AND 1.97 ANGSTROMS REFINEMENT CYCLE 73 IS 0.254. as appears in entries such as 1LZT. Here, the first number is the number of reflections. There is thus a kludge which sets the R-factor to zero if it was read as greater than 0.5 to avoid this situation. In these cases, we lose the R-factor information. This occurs in approx 3.5% of the 1XXX PDB entries.</p>
<ul>
<li>25.02.94 Original By: ACRM</li>
<li>28.02.94 Added " R = " and check that VALUE wasn't B-VALUE</li>
<li>17.07.96 Added check for EXPERIMENT TYPE : THEORETICAL MODEL Also fixed bug in searching REMARK record</li>
<li>27.06.97 Added handing of RESOLUTION records which point you to another record for the experiment type. Fixed some calls to FindNextNumber() which were checking an 80 character width Fixed EXPERIMENT TYPE to look for NMR as well Looks for EXPDTA NMR record</li>
<li>23.03.98 Added check that RESOLUTION record is in a REMARK 2</li>
<li>08.02.99 Now a wrapper to GetExptl() which also returns FreeR</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00193">193</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4d5b4d6154f9efed0b1bf00dcb5aa16b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blGetResolWholePDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td>
          <td class="paramname"><em>wpdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>RFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>StrucType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*wpdb</td><td>WHOLEPDB structure pointer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*resolution</td><td>The resolution (0.0 if not applicable) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*RFactor</td><td>The R-factor (0.0 if not found) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*StrucType</td><td>Structure type: STRUCTURE_TYPE_XTAL STRUCTURE_TYPE_NMR STRUCTURE_TYPE_MODEL STRUCTURE_TYPE_UNKNOWN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if resolution found or valid structure type found</dd></dl>
<p>This routine attempts to obtain resolution and R-factor information out of a WHOLEPDB structure. It returns TRUE or FALSE to indicate whether valid information was found. Resolution-not-applicable structures then have the resolution set to zero.</p>
<p>N.B. The resolution information returned by the routine is reliable; the R-factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-factor to be the first number after the words `R-value' (or one of the other keys - see the case statement in the code for the valid keywords). Thus we cannot handle records of the form: THE R-VALUE FOR 7142 REFLECTIONS BETWEEN 10.0 AND 1.97 ANGSTROMS REFINEMENT CYCLE 73 IS 0.254. as appears in entries such as 1LZT. Here, the first number is the number of reflections. There is thus a kludge which sets the R-factor to zero if it was read as greater than 0.5 to avoid this situation. In these cases, we lose the R-factor information. This occurs in approx 3.5% of the 1XXX PDB entries.</p>
<ul>
<li>02.03.15 Original By: ACRM </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00244">244</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a570868c653dcba07ecddf06b1a15c4b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* blReportStructureType </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>StrucType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">StrucType</td><td>Stucture type returned by ResolPDB() </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Stucture type description.</dd></dl>
<p>Returns structure description.</p>
<pre class="fragment">  STRUCTURE_TYPE_UNKNOWN     Unknown
  STRUCTURE_TYPE_XTAL        X-ray crystal structure
  STRUCTURE_TYPE_NMR         NMR
  STRUCTURE_TYPE_MODEL       Model
  STRUCTURE_TYPE_ELECTDIFF   Electron Diffraction
  STRUCTURE_TYPE_FIBER       Fiber Diffraction
  STRUCTURE_TYPE_SSNMR       Solid State NMR
  STRUCTURE_TYPE_NEUTRON     Neutron Scattering
  STRUCTURE_TYPE_EM          Electron Miscroscopy
  STRUCTURE_TYPE_SOLSCAT     Solution Scattering
  STRUCTURE_TYPE_IR          Infra-red Spectroscopy
  STRUCTURE_TYPE_POWDER      Powder Diffraction
  STRUCTURE_TYPE_FRET        Fluorescence Transfer
</pre><ul>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_resol_p_d_b_8c_source.html#l00410">410</a> of file <a class="el" href="_resol_p_d_b_8c_source.html">ResolPDB.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 06:58:47 for Bioplib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
