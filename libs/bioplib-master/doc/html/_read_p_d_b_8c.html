<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Bioplib: /serv/www/html_lilian/bioplib-master/src/ReadPDB.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bioplib
   </div>
   <div id="projectbrief">Protein Structure C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ReadPDB.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Read coordinates from a PDB file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="port_8h_source.html">port.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_sys_defs_8h_source.html">SysDefs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_math_type_8h_source.html">MathType.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pdb_8h_source.html">pdb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fsscanf_8h_source.html">fsscanf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="general_8h_source.html">general.h</a>&quot;</code><br/>
</div>
<p><a href="_read_p_d_b_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7c2049834b572b318eef04a20dfbfa6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a7c2049834b572b318eef04a20dfbfa6f">READPDB_MAIN</a></td></tr>
<tr class="separator:a7c2049834b572b318eef04a20dfbfa6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a457cbd80b17488f3be1deea377c79008"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a457cbd80b17488f3be1deea377c79008">MAXPARTIAL</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a457cbd80b17488f3be1deea377c79008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c78d2f8feb311dd9fc969a0bf84979"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>&#160;&#160;&#160;0.000001</td></tr>
<tr class="separator:a09c78d2f8feb311dd9fc969a0bf84979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a516526b51408fb9c76e9080a076ce7a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a516526b51408fb9c76e9080a076ce7a9">XML_BUFFER</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:a516526b51408fb9c76e9080a076ce7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3226aff6ea754ae66a7d523b57db4ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aa3226aff6ea754ae66a7d523b57db4ce">XML_SAMPLE</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:aa3226aff6ea754ae66a7d523b57db4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a0c8dad16ba61ded55d3f302a616c0ced">MAXBUFF</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc27c0a815743fee098c0ae1c2799e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a2cc27c0a815743fee098c0ae1c2799e7">LOCATION_HEADER</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a2cc27c0a815743fee098c0ae1c2799e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa94eb868b56cdfc5dc6f46e66407a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#adaa94eb868b56cdfc5dc6f46e66407a0">LOCATION_COORDINATES</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:adaa94eb868b56cdfc5dc6f46e66407a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1147d9301741585883343096c5e1d5e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aa1147d9301741585883343096c5e1d5e">LOCATION_TRAILER</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa1147d9301741585883343096c5e1d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a31dd4384020447c7d99d0e4aace6f17a"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a31dd4384020447c7d99d0e4aace6f17a">popen</a> (const char *, const char *)</td></tr>
<tr class="separator:a31dd4384020447c7d99d0e4aace6f17a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e41b535f1505676ed8cbe5896606d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a92e41b535f1505676ed8cbe5896606d5">pclose</a> (FILE *)</td></tr>
<tr class="separator:a92e41b535f1505676ed8cbe5896606d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4027e61f67886772894d7a948a3be2c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a4027e61f67886772894d7a948a3be2c0">blReadPDB</a> (FILE *fp, int *natom)</td></tr>
<tr class="separator:a4027e61f67886772894d7a948a3be2c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23cbc720ce99c3bdaf61d42960df970a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a23cbc720ce99c3bdaf61d42960df970a">blReadPDBAll</a> (FILE *fp, int *natom)</td></tr>
<tr class="separator:a23cbc720ce99c3bdaf61d42960df970a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3668492022bd2b8fb630dd2ee250b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#acd3668492022bd2b8fb630dd2ee250b7">blReadPDBAtoms</a> (FILE *fp, int *natom)</td></tr>
<tr class="separator:acd3668492022bd2b8fb630dd2ee250b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa303aa30446e8ca03c7deb6b6a496dc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aa303aa30446e8ca03c7deb6b6a496dc6">blReadPDBOccRank</a> (FILE *fp, int *natom, int OccRank)</td></tr>
<tr class="separator:aa303aa30446e8ca03c7deb6b6a496dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa282352d949c323303ef5323432006f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aa282352d949c323303ef5323432006f2">blReadPDBAtomsOccRank</a> (FILE *fp, int *natom, int OccRank)</td></tr>
<tr class="separator:aa282352d949c323303ef5323432006f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e2da8a66d45fa7383377f0bc2a96f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aa5e2da8a66d45fa7383377f0bc2a96f8">blDoReadPDB</a> (FILE *fpin, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> AllAtoms, int OccRank, int ModelNum, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> DoWhole)</td></tr>
<tr class="separator:aa5e2da8a66d45fa7383377f0bc2a96f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4beae504260cb072d1807d1e3aaa1982"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a4beae504260cb072d1807d1e3aaa1982">blFixAtomName</a> (char *name, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> occup)</td></tr>
<tr class="separator:a4beae504260cb072d1807d1e3aaa1982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c0ace6d46e2c0a56ce4bea451e76c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a10c0ace6d46e2c0a56ce4bea451e76c3">blRemoveAlternates</a> (<a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *pdb)</td></tr>
<tr class="separator:a10c0ace6d46e2c0a56ce4bea451e76c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b7fa3f71a70211cfd355204b48d4fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a68b7fa3f71a70211cfd355204b48d4fc">blDoReadPDBML</a> (FILE *fpin, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> AllAtoms, int OccRank, int ModelNum, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> DoWhole)</td></tr>
<tr class="separator:a68b7fa3f71a70211cfd355204b48d4fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02bf1675328de6d4ce5d398ebd0c4c7a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML</a> (FILE *fp)</td></tr>
<tr class="separator:a02bf1675328de6d4ce5d398ebd0c4c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee33316d776fc479c656a3f9f0c7a84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aeee33316d776fc479c656a3f9f0c7a84">blFreeWholePDB</a> (<a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *wpdb)</td></tr>
<tr class="separator:aeee33316d776fc479c656a3f9f0c7a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac630c13aff6802b905c10ce97d64761"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#aac630c13aff6802b905c10ce97d64761">blReadWholePDB</a> (FILE *fpin)</td></tr>
<tr class="separator:aac630c13aff6802b905c10ce97d64761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ce69a8cb41874090869c11246e0b0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_read_p_d_b_8c.html#a56ce69a8cb41874090869c11246e0b0e">blReadWholePDBAtoms</a> (FILE *fpin)</td></tr>
<tr class="separator:a56ce69a8cb41874090869c11246e0b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Read coordinates from a PDB file. </p>
<dl class="section version"><dt>Version</dt><dd>V3.13 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11.12.20 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) UCL / Dr. Andrew C. R. Martin 1988-2020 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dr. Andrew C. R. Martin </dd></dl>
<dl class="section user"><dt></dt><dd>Institute of Structural &amp; Molecular Biology, University College London, Gower Street, London. WC1E 6BT. </dd></dl>
<dl class="section user"><dt></dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w@b'+'io'+'inf'+'.o'+'rg.'+'uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w@bi<span style="display: none;">.nosp@m.</span>oinf.<span style="display: none;">.nosp@m.</span>org.<span style="display: none;">.nosp@m.</span>uk</a> <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w.m'+'ar'+'tin'+'@u'+'cl.'+'ac'+'.uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w.ma<span style="display: none;">.nosp@m.</span>rtin@<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a></dd></dl>
<p>This code is NOT IN THE PUBLIC DOMAIN, but it may be copied according to the conditions laid out in the accompanying file COPYING.DOC.</p>
<p>The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.</p>
<p>The code may not be sold commercially or included as part of a commercial product except as described in the file COPYING.DOC.</p>
<h1>Description: </h1>
<div class="fragment"><div class="line">pdb = ReadPDB(fp,natom)</div>
</div><!-- fragment --><p>This subroutine will read a .PDB file of any size and form a linked list of the protein structure. This list is contained in a linked set of structures of type <a class="el" href="structpdb__entry.html">pdb_entry</a>. The structure is set up by including the file "pdb.h". For details of the structure, see this file.</p>
<p>To free the space created by this routine, call <a class="el" href="safemem_8h.html#a4151f4e24778e7b290ec804c29c91f27">FREELIST(pdb,PDB)</a>.</p>
<p>The parameters passed to the subroutine are:</p>
<ul>
<li>fp - A pointer to type FILE in which the .PDB file is stored.</li>
<li>pdb - A pointer to type PDB.</li>
<li>natom - A pointer to type integer in which the number of atoms found is stored.</li>
</ul>
<p>As of V2.3, the routine makes provision for partial occupancies. If the occupancies are 1.0 or 0.0, the atoms are read verbatim. If not, only the highest occupancy atoms are read and the atom names are corrected to remove alternative labels. This behaviour can be overridden by calling one of the ...OccRank() routines to read lower occupancy atoms. If any partial occupancy atoms are read the global flag gPDBPartialOcc is set to TRUE.</p>
<p>The various PDB reading routines set the following global flags: gPDBPartialOcc - the PDB file contained multiple occupancies gPDBMultiNMR - the PDB file contained multiple models gPDBXML - the file was in PDBML (XML) format gPDBModelNotFound - the requested model was not found</p>
<p>NOTE: Although some of the fields are represented by a single character, they are still stored in character arrays.</p>
<p>BUGS: The subroutine cannot read files with VAX Fortran carriage control! It just sits there and page faults like crazy.</p>
<p>BUGS: The multiple occupancy code assumes that all positions for a given atom in consecutive records of the file</p>
<p>BUGS: 25.01.05 Note the multiple occupancy code won't work properly for 3pga where atoms have occupancies of zero and one</p>
<h1>Usage: </h1>
<div class="fragment"><div class="line">pdb = <a class="code" href="pdb_8h.html#a4027e61f67886772894d7a948a3be2c0">blReadPDB</a>(fp,natom)</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>*pdb A pointer to the first allocated item of the PDB linked list</dd></dl>
<h1>Revision History: </h1>
<ul>
<li>V1.0 04.11.88 Original</li>
<li>V1.1 07.02.89 Now ignores any records from the .PDB file which don't start with ATOM or HETATM.</li>
<li>V1.2 28.03.90 Some fields altered to match the exact specifications of the PDB. The only differences from the standard are:<ol type="1">
<li>The residue name is 4 characters rather than 3 (allowing LYSH, HISA, etc.).</li>
<li>The atom name starts one column later than the standard and is four columns wide encompasing the standard's `alternate' field. These two differences from the standard reflect the common usage.</li>
</ol>
</li>
<li>V1.2a 28.06.90 Buffer size increased to 85 chars.</li>
<li>V1.2b 15.02.91 Simply changed comment header to match new standard.</li>
<li>V1.3 07.01.92 Corrected small bug in while() loop. Now ignores blank lines properly</li>
<li>V1.4 11.05.92 Added check on EOF in while() loop and memset() of buffer. ANSIfied.</li>
<li>V1.5 01.06.92 Documented for autodoc</li>
<li>V1.7 01.10.92 Changed to use fgets()</li>
<li>V1.6 19.06.92 Corrected use of stdlib</li>
<li>V1.8 08.12.92 SAS/C V6 now defines atof() in stdlib</li>
<li>V1.9 10.06.93 Returns TRUE or FALSE rather than exiting on failure</li>
<li>V2.0 17.06.93 Rewritten to use <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a></li>
<li>V2.1 08.07.93 Modified to give ReadPDB() and ReadPDBAtoms()</li>
<li>V2.2 09.07.93 Modified to return the PDB pointer rather than a BOOL. There is now no need to initialise the structure first. Rewrote allocation scheme.</li>
<li>V2.3 17.03.94 Handles partial occupancies. If occupancies are not 1.0 or 0.0, the normal routine now reads only the highest occupancy atoms and corrects the atoms names to remove alternative labels. This behaviour can be overridden by calling one of the ...OccRank() routines to read lower occupancy atoms. Sets natom to -1 if there was an error to distinguish from no atoms. Handles atom names which start in column 13 rather than column 14. This is allowed in the standard, but very rare. Added ReadPDBOccRank() &amp; ReadPDBAtomsOccRank() Sets gPDBPartialOcc flag.</li>
<li>V2.4 06.04.94 With atom names which start in column 13, now checks if the first character is a digit. If so, moves it to the end of the atom name. Thus, 1HH1 becomes HH11 and 2HH1 becomes HH12.</li>
<li>V2.5 04.10.94 Fixed partial occ when resnum changes as well as atom name. Fixed bug when MAXPARTIAL exceeded.</li>
<li>V2.6 03.11.94 Simply Corrected description. No code changes</li>
<li>V2.7 06.03.95 Now reads just the first NMR model by default doReadPDB() no longer static Sets gPDBMultiNMR if ENDMDL records found.</li>
<li>V2.8 13.01.97 Added check on return from fsscanf. Blank lines used to result in duplication of the previous line since <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a> does not reset the variables on receiving a blank line. Also fixed in <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a>.</li>
<li>V2.9 25.02.98 Added transparent reading of gzipped PDB files if GUNZIP_SUPPORT is defined</li>
<li>V2.10 18.08.98 Added cast to <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> for SunOS</li>
<li>V2.11 08.10.99 Initialised some variables</li>
<li>V2.12 15.02.01 Added atnam_raw into PDB structure</li>
<li>V2.13 30.05.02 Changed PDB field from 'junk' to 'record_type'</li>
<li>V2.14 27.04.05 Fixed bug in atnam_raw for multiple occupancies</li>
<li>V2.15 03.06.05 Added altpos field to PDB structure. The massaged atom name no longer contains the alternate indicator and atnam_raw has only the atom name with altpos having the alternate indicator (as it should!)</li>
<li>V2.16 14.10.05 Fixed a problem in StoreOccRankAtom() when a lower occupancy atom has (erroneously) been set to occupancy of zero and you want to pull out that atom</li>
<li>V2.17 25.01.06 Added calls to RemoveAlternates()</li>
<li>V2.18 03.02.06 Added prototypes for <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> and <a class="el" href="openorpipe_8c.html#a92e41b535f1505676ed8cbe5896606d5">pclose()</a></li>
<li>V2.19 05.06.07 Added support for Unix compress'd files</li>
<li>V2.20 29.06.07 <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> and <a class="el" href="openorpipe_8c.html#a92e41b535f1505676ed8cbe5896606d5">pclose()</a> prototypes now skipped for MAC OSX which defines them differently</li>
<li>V2.21 17.03.09 <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> prototype skipped for Windows. By: CTP</li>
<li>V2.22 21.12.11 doReadPDB() modified for cases where atoms are single occupancy but occupancy is &lt; 1.0</li>
<li>V2.23 04.02.14 Use CHAINMATCH macro. By: CTP</li>
<li>V2.24 22.04.14 Added PDBML parsing with doReadPDBML() and CheckFileFormatPDBML(). By CTP</li>
<li>V2.25 02.06.14 Updated doReadPDBML(). By: CTP</li>
<li>V2.26 09.06.14 Set gPDBXML flag. By: CTP</li>
<li>V2.27 07.07.14 Renaming of functions with "bl" prefix. By: CTP</li>
<li>V2.28 04.08.14 <a class="el" href="pdb_8h.html#a4027e61f67886772894d7a948a3be2c0">blReadPDB()</a> and blReadPDBML() get element and charge. Set access and radius to 0.0. Set atomType to NULL. Added blProcessElementField() and blProcessChargeField() By: CTP</li>
<li>V2.29 15.08.14 Updated <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> and <a class="el" href="pdb_8h.html#acfe34022af3ca82b7a6cb218fae608a8">blDoReadPDBML()</a> to use <a class="el" href="pdb_8h.html#aa060eecccbc29f0bfbbaf442b42d0cdc">CLEAR_PDB()</a>. By: CTP</li>
<li>V2.30 16.08.14 Replaced charge with formal_charge and partial_charge for PDB structure. By: CTP</li>
<li>V2.31 18.08.14 Added XML_SUPPORT option allowing compilation without support for PDBML format. By: CTP</li>
<li>V2.32 26.08.14 <a class="el" href="pdb_8h.html#acfe34022af3ca82b7a6cb218fae608a8">blDoReadPDBML()</a> pads record type to six chars. By: CTP</li>
<li>V2.33 29.08.14 Rewrote <a class="el" href="pdb_8h.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML()</a> to take sample from input steam then push sample back on stream. By: CTP</li>
<li>V2.34 31.08.14 Fixed bug in <a class="el" href="pdb_8h.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML()</a>. By: CTP</li>
<li>V2.35 09.09.14 Updated <a class="el" href="pdb_8h.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML()</a> for non-unix systems. Decreased size of XML_SAMPLE. Reading of gzipped files with gunzip not supported for MS Windows. By: CTP</li>
<li>V2.36 29.09.14 Allow single character check for filetype where ungetc() fails after pushback of single character. Updates to <a class="el" href="pdb_8h.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML()</a> and <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a>. By: CTP</li>
<li>V2.37 17.02.15 Added segid support By: ACRM</li>
<li>V3.0 20.02.15 Merged functionality of ReadWholePDB() into this</li>
<li>V3.1 25.02.15 Enhanced error checking and safety of <a class="el" href="pdb_8h.html#acfe34022af3ca82b7a6cb218fae608a8">blDoReadPDBML()</a></li>
<li>V3.2 05.03.15 Fixed core dump in StoreConectRecords() when alternates have been deleted so CONECT specifies an atom that doesn't exist any more</li>
<li>V3.3 20.03.15 Fixed reading of whole PDB when not the first model Now sets gPDBModelNotFound flag if the requested model isn't found</li>
<li>V3.4 03.04.15 Rewind file after reading pdbxml header data. Initialize pdb to NULL for ReadPDB functions. By: CTP</li>
<li>V3.5 13.05.15 Added COMPND and SOURCE parsing for PDBML-format By: CTP</li>
<li>V3.6 23.06.15 Parse entity_id from PDBML files. Parse chain for COMPND records from PDBML files. Restrict compnd type to polymer entries. Parse SEQRES records from PDBML files. By: CTP</li>
<li>V3.7 23.06.15 blStoreOccRankAtom() properly clears new PDB items</li>
<li>V3.8 24.06.15 Parse MODRES records from PDBML files. By: CTP</li>
<li>V3.9 25.06.15 Added experimental data support. Fixed some memory leaks. Tidied up comments and formatting. Renamed all static functions so they don't start with bl. Added checks for failed XML extractions.</li>
<li>V3.10 25.06.15 Fixed bug for pdbml parsing where residue number is set to 0. By: CTP</li>
<li>V3.11 01.07.15 Added ParseHeaderRecordsPDBML(). ParseHeaderPDBML() broken into smaller functions: ParseTitlePDBML(), ParseCompndPDBML(), ParseSourcePDBML(), ParseResolPDBML(), ParseSeqresPDBML() and ParseModresPDBML(). By: CTP</li>
<li>V3.12 07.08.18 Increased text buffer sizes to silence gcc 7.3.1 with -O2 By: ACRM</li>
<li>V3.13 11.12.20 More checks before <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> prototype </li>
</ul>

<p>Definition in file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="adaa94eb868b56cdfc5dc6f46e66407a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOCATION_COORDINATES&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00343">343</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2cc27c0a815743fee098c0ae1c2799e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOCATION_HEADER&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00342">342</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa1147d9301741585883343096c5e1d5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOCATION_TRAILER&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00344">344</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0c8dad16ba61ded55d3f302a616c0ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXBUFF&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00340">340</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a457cbd80b17488f3be1deea377c79008"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXPARTIAL&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00336">336</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7c2049834b572b318eef04a20dfbfa6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define READPDB_MAIN</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00310">310</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a09c78d2f8feb311dd9fc969a0bf84979"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMALL&#160;&#160;&#160;0.000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00337">337</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a516526b51408fb9c76e9080a076ce7a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XML_BUFFER&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00338">338</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa3226aff6ea754ae66a7d523b57db4ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XML_SAMPLE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00339">339</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a02bf1675328de6d4ce5d398ebd0c4c7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blCheckFileFormatPDBML </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>File is in PDBML format?</dd></dl>
<p>Simple test to detect PDBML-formatted pdb file.</p>
<p>Todo: Consider replacement with general function to detect file format for uncompressed file returning file type (eg pdb/pdbml/unknown).</p>
<ul>
<li>22.04.14 Original By: CTP</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a02bf1675328de6d4ce5d398ebd0c4c7a">blCheckFileFormatPDBML()</a> By: CTP</li>
<li>29.08.14 Function re-written to take sample from the input stream then reset the stream with ungetc. By: CTP</li>
<li>31.08.14 Bugfix: Check for 'PDBx:datablock' tag skipped if blank line before xml tag. By: CTP</li>
<li>09.09.14 Use rewind() for DOS instead of pushing sample back on stream with ungetc(). By: CTP</li>
<li>29.09.14 Use single character check for pdbml files for Windows or systems where ungetc() fails after pushback of singe char. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l02164">2164</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa5e2da8a66d45fa7383377f0bc2a96f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a>* blDoReadPDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fpin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>AllAtoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OccRank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ModelNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>DoWhole</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fpin</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllAtoms</td><td>TRUE: ATOM &amp; HETATM records FALSE: ATOM records only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OccRank</td><td>Occupancy ranking </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ModelNum</td><td>NMR Model number (0 = all) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DoWhole</td><td>Read the whole PDB file rather than just the ATOM/HETATM records. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a malloc'd WHOLEPDB structure</dd></dl>
<p>Reads a PDB file into a PDB linked list. The OccRank value indicates occupancy ranking to read for partial occupancy atoms. If any partial occupancy atoms are read the global flag gPDBPartialOcc is set to TRUE.</p>
<ul>
<li>04.11.88 V1.0 Original</li>
<li>07.02.89 V1.1 Ignore records which aren't ATOM or HETATM</li>
<li>28.03.90 V1.2 Altered field widths to match PDB standard better See notes above for deviations</li>
<li>28.06.90 V1.2a Buffer size increased to 85 chars.</li>
<li>15.02.91 V1.2b Changed comment header to match new standard.</li>
<li>07.01.92 V1.3 Ignores blank lines properly</li>
<li>11.05.92 V1.4 Check on EOF in while() loop, memset() buffer. ANSIed.</li>
<li>01.06.92 V1.5 Documented for autodoc</li>
<li>19.06.92 V1.6 Corrected use of stdlib</li>
<li>01.10.92 V1.7 Changed to use fgets()</li>
<li>10.06.93 V1.9 Returns 0 on failure rather than exiting Replaced SIZE with sizeof(PDB) directly</li>
<li>17.06.93 V2.0 Rewritten to use <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a></li>
<li>08.07.93 V2.1 Split from ReadPDB()</li>
<li>09.07.93 V2.2 Modified to return pointer to PDB. Rewrote allocation scheme.</li>
<li>17.03.94 V2.3 Handles partial occupancies Sets natom to -1 if there was an error to distinguish from no atoms. Handles atom names which start in column 13 rather than column 14. This is allowed in the standard, but very rare. Sets flag for partials.</li>
<li>06.04.94 V2.4 Atom names starting in column 13 have their first character moved to the end if it is a digit.</li>
<li>03.10.94 V2.5 Check residue number as well as atom name when running through alternative atoms for partial occupancy Moved increment of NPartial, so only done if there is space in the array. If OccRank is 0, all atoms are read regardless of occupancy.</li>
<li>06.03.95 V2.7 Added value for NMR model to read (0 = all) No longer static. Sets gPDBMultiNMR if ENDMDL records found.</li>
<li>13.01.97 V2.8 Added check on return from fsscanf. Blank lines used to result in duplication of the previous line since <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a> does not reset the variables on receiving a blank line. Also fixed in <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a>.</li>
<li>25.02.98 V2.9 Added code to read gzipped PDB files transparently when GUNZIP_SUPPORT is defined</li>
<li>17.08.98 V2.10 Added case to <a class="el" href="openorpipe_8c.html#af78772fbd79937a93ce4a787b011a520">popen()</a> for SunOS</li>
<li>08.10.99 V2.11 Initialise CurIns and CurRes</li>
<li>15.02.01 V2.12 Added atnam_raw</li>
<li>27.04.05 V2.14 Added another atnam_raw for multiple occupancies</li>
<li>03.06.05 V2.15 Added altpos</li>
<li>14.10.05 V2.16 Modified detection of partial occupancy. handles residues like 1zeh/B16 where a lower partial is erroneously set to zero</li>
<li>05.06.07 V2.19 Added support for Unix compress'd files</li>
<li>21.12.11 V2.22 Modified for cases of single occupancy &lt; 1.0</li>
<li>22.04.14 V2.24 Call doReadPDBML() for PDBML-formatted PDB file. By: CTP</li>
<li>02.06.14 V2.25 Updated doReadPDBML(). By: CTP</li>
<li>09.06.14 V2.26 Set gPDBXML flag. By: CTP</li>
<li>07.07.14 V2.27 Renamed to <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> By: CTP</li>
<li>15.08.14 V2.29 Use <a class="el" href="pdb_8h.html#aa060eecccbc29f0bfbbaf442b42d0cdc">CLEAR_PDB()</a> to set default values. By: CTP</li>
<li>16.08.14 V2.30 Replaced charge with formal_charge and partial_charge for PDB structure. By: CTP</li>
<li>18.08.14 V2.31 Added XML_SUPPORT option allowing BiopLib to be compiled without support for PDBML format. By: CTP</li>
<li>09.09.14 V2.35 Reading of gzipped files with gunzip not supported for MS Windows. By: CTP</li>
<li>29.09.14 V2.36 Allow single character filetype check for gzipped files. By: CTP</li>
<li>17.02.15 V2.37 Added segid support By: ACRM</li>
<li>20.02.15 V3.0 NOT COMPATIBLE WITH PREVIOUS VERSIONS. The functionality of the old ReadWholePDB() is now integrated into this function.</li>
<li>20.03.15 V3.3 Fixed behaviour with reading other than the first model and now sets a global error flag if the requested model was not found. Uses MODEL records rather than ENDMDL records in counting models</li>
<li>02.04.15 V3.4 Rewind file after reading pdbxml header data. By: CTP</li>
<li>28.04.15 V3.5 Removed rewind. Call to <a class="el" href="pdb_8h.html#acfe34022af3ca82b7a6cb218fae608a8">blDoReadPDBML()</a> returns WHOLEPDB instead of PDB. By: CTP</li>
<li><p class="startli">21.07.15 Changed atomType to atomInfo By: ACRM</p>
<p class="startli">We need to deal with freeing wpdb if we are returning null. Also need to deal with some sort of error code </p>
</li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00710">710</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a68b7fa3f71a70211cfd355204b48d4fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a>* blDoReadPDBML </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fpin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>AllAtoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OccRank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ModelNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>DoWhole</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fpin</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllAtoms</td><td>TRUE: ATOM &amp; HETATM records FALSE: ATOM records only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OccRank</td><td>Occupancy ranking </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ModelNum</td><td>NMR Model number (0 = all) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DoWhole</td><td>Read the whole PDB file rather than just the ATOM/HETATM records. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a malloc'd WHOLEPDB structure.</dd></dl>
<p>Reads a PDBML-formatted PDB file into a PDB linked list.</p>
<p>The OccRank value indicates occupancy ranking to read for partial occupancy atoms. If any partial occupancy atoms are read the global flag gPDBPartialOcc is set to TRUE.</p>
<p>The global multiple-models flag is set to true if more than one model is found.</p>
<p>Returns NULL if memory allocation fails or returns wpdb with wpdb-&gt;pdb set to NULL and wpdb-&gt;natoms set to -1.</p>
<ul>
<li>22.04.14 Original By: CTP</li>
<li>02.06.14 Updated setting atnam_raw and parsing data from PDB atom site labels (label_seq_id, etc.) if author-defined labels are omitted. By: CTP</li>
<li>09.06.14 Set gPDBXML flag. By: CTP</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#acfe34022af3ca82b7a6cb218fae608a8">blDoReadPDBML()</a> By: CTP</li>
<li>04.08.14 Read element and formal charge. By: CTP</li>
<li>15.08.14 Use <a class="el" href="pdb_8h.html#aa060eecccbc29f0bfbbaf442b42d0cdc">CLEAR_PDB()</a> to set default values. By: CTP</li>
<li>16.08.14 Read formal and partial charges. Use <a class="el" href="_copy_p_d_b_8c.html#a80b3db4e74f9217af845d60f9b0b0204">blCopyPDB()</a> to copy data for partial occupancy atoms. By: CTP</li>
<li>18.08.14 Added XML_SUPPORT option. Return error if XML_SUPPORT not defined By: CTP</li>
<li>26.08.14 Pad record_type to six characters. By: CTP</li>
<li>17.02.15 Added segid support By: ACRM</li>
<li>25.02.15 Added some checks on potential NULL pointers Changed all strcpy()s to strncpy()s Initialized numeric content variable before each sscanf() in case it fails Calls <a class="el" href="pdb_8h.html#ae1ff7a56e4d028aef80c0220f59c1358">blRenumAtomsPDB()</a> at the end since we don't use the atom site IDs for atom numbers</li>
<li>13.03.15 Cosmetic changes</li>
<li>28.04.15 Set identical input parameters to <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a>. Added CONECT and header parsing. Return WHOLEPDB instead of PDB. By: CTP</li>
<li>14.06.15 Read entity_id By: CTP</li>
<li>25.06.15 Detect if residue number has been set from auth_seq_id using flag - fixes bug where auth_seq_id = 0. By: CTP</li>
<li>01.07.15 Replaced ParseHeaderPDBML() with ParseHeaderRecordsPDBML() By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l01627">1627</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4beae504260cb072d1807d1e3aaa1982"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* blFixAtomName </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a>&#160;</td>
          <td class="paramname"><em>occup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*name</td><td>Atom name read from file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occup</td><td>Occupancy to allow fixing of partial occupancy atom names </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Fixed atom name (pointer into name)</dd></dl>
<p>Fixes an atom name by removing leading spaces, or moving a leading digit to the end of the string. Used by doReadPDB()</p>
<ul>
<li>06.04.94 Original By: ACRM</li>
<li>01.03.01 No longer static</li>
<li>03.06.05 The name passed in has always contained the column which is officially the alternate atom position indicator, but is used by some programs as part of the atom name. Thus the properly constructed variable coming into the routine should be something like '1HG1 ' or '1HG1A' for an alternate atom position. However some programs use ' HG11'. Therefore we now check for a character in the last position and replace it with a space if there is a space in the preceeding position (e.g. ' CA A' -&gt; ' CA ') or if there is a character in the first position (e.g. '1HG1A' -&gt; '1HG1 ') or if the occupancy is not zero/one NOTE!!! To support this, the routine now has a second parameter: REAL occup</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a4beae504260cb072d1807d1e3aaa1982">blFixAtomName()</a> By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l01294">1294</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aeee33316d776fc479c656a3f9f0c7a84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void blFreeWholePDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a> *&#160;</td>
          <td class="paramname"><em>wpdb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*wpdb</td><td>WHOLEPDB structure to be freed</td></tr>
  </table>
  </dd>
</dl>
<p>Frees the header, trailer and atom content from a WHOLEPDB structure</p>
<ul>
<li>30.05.02 Original By: ACRM</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#aeee33316d776fc479c656a3f9f0c7a84">blFreeWholePDB()</a> By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l02296">2296</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4027e61f67886772894d7a948a3be2c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blReadPDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>natom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read. -1 if error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first allocated item of the PDB linked list</dd></dl>
<p>Reads a PDB file into a PDB linked list</p>
<ul>
<li>08.07.93 Written as entry for doReadPDB()</li>
<li>09.07.93 Modified to return pointer to PDB</li>
<li>17.03.94 Modified to handle OccRank</li>
<li>06.03.95 Added value for NMR model to read (1 = first)</li>
<li>25.01.06 Added call to RemoveAlternates() - this deals with odd cases where alternate atom positions don't appear where they should!</li>
<li>25.01.06 Added call to RemoveAlternates(). This deals with odd uses of multiple occupancies like 3pga and the instance where the alternates are all grouped at the end of the file.</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a4027e61f67886772894d7a948a3be2c0">blReadPDB()</a> By: CTP</li>
<li>03.04.15 Initialize pdb to NULL avoiding returning uninitialized value if <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> fails. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00422">422</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a23cbc720ce99c3bdaf61d42960df970a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blReadPDBAll </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>natom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read. -1 if error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first allocated item of the PDB linked list</dd></dl>
<p>Reads a PDB file into a PDB linked list. Reads all partial occupancy atoms. Reads both ATOM and HETATM records.</p>
<ul>
<li>04.10.94 Original By: ACRM</li>
<li>06.03.95 Added value for NMR model to read (0 = all)</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a23cbc720ce99c3bdaf61d42960df970a">blReadPDBAll()</a> By: CTP</li>
<li>03.04.15 Initialize pdb to NULL avoiding returning uninitialized value if <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> fails. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00463">463</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="acd3668492022bd2b8fb630dd2ee250b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blReadPDBAtoms </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>natom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read. -1 if error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first allocated item of the PDB linked list</dd></dl>
<p>Reads a PDB file into a PDB linked list. Atoms only (no HETATM cards).</p>
<ul>
<li>08.07.93 Written as entry for doReadPDB()</li>
<li>09.07.93 Modified to return pointer to PDB</li>
<li>17.03.94 Modified to handle OccRank</li>
<li>06.03.95 Added value for NMR model to read (1 = first)</li>
<li>25.01.06 Added call to RemoveAlternates(). This deals with odd uses of multiple occupancies like 3pga and the instance where the alternates are all grouped at the end of the file.</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#acd3668492022bd2b8fb630dd2ee250b7">blReadPDBAtoms()</a> By: CTP</li>
<li>03.04.15 Initialize pdb to NULL avoiding returning uninitialized value if <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> fails. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00506">506</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa282352d949c323303ef5323432006f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blReadPDBAtomsOccRank </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>natom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OccRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OccRank</td><td>Occupancy ranking (&gt;=1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read. -1 if error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first allocated item of the PDB linked list</dd></dl>
<p>Reads a PDB file into a PDB linked list ignoring HETATM records and selecting the OccRank'th highest occupancy atoms</p>
<ul>
<li>17.03.94 Original By: ACRM</li>
<li>06.03.95 Added value for NMR model to read (1 = first)</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#aa282352d949c323303ef5323432006f2">blReadPDBAtomsOccRank()</a> By: CTP</li>
<li>03.04.15 Initialize pdb to NULL avoiding returning uninitialized value if <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> fails. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00589">589</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa303aa30446e8ca03c7deb6b6a496dc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blReadPDBOccRank </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>natom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OccRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>A pointer to type FILE in which the .PDB file is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OccRank</td><td>Occupancy ranking (&gt;=1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*natom</td><td>Number of atoms read. -1 if error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the first allocated item of the PDB linked list</dd></dl>
<p>Reads a PDB file into a PDB linked list selecting the OccRank'th highest occupancy atoms</p>
<ul>
<li>17.03.94 Original By: ACRM</li>
<li>06.03.95 Added value for NMR model to read (1 = first)</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> By: CTP</li>
<li>03.04.15 Initialize pdb to NULL avoiding returning uninitialized value if <a class="el" href="pdb_8h.html#a9000383ee976cc74170f8369d15e3543">blDoReadPDB()</a> fails. By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l00548">548</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="aac630c13aff6802b905c10ce97d64761"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a>* blReadWholePDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fpin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fpin</td><td>File pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whole PDB structure containing linked list to PDB coordinate data</dd></dl>
<p>Reads a PDB file, storing the header and trailer information as well as the coordinate data. Can read gzipped files as well as uncompressed files.</p>
<p>Coordinate data is accessed as linked list of type PDB as follows:</p>
<p>WHOLEPDB *wpdb; PDB *p; wpdb = ReadWholePDB(fp); for(p=wpdb-&gt;pdb; p!=NULL; p=p-&gt;next) { ... Do something with p ... }</p>
<ul>
<li>07.03.07 Made into a wrapper to doReadWholePDB()</li>
<li>07.07.14 Use blDoReadWholePDB() Renamed to <a class="el" href="pdb_8h.html#aac630c13aff6802b905c10ce97d64761">blReadWholePDB()</a> By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l02331">2331</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a56ce69a8cb41874090869c11246e0b0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#af81d935f76d79bf5a92ed72a1db6ebd8">WHOLEPDB</a>* blReadWholePDBAtoms </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fpin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fpin</td><td>File pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whole PDB structure containing linked list to PDB coordinate data</dd></dl>
<p>Reads a PDB file, storing the header and trailer information as well as the coordinate data. Can read gzipped files as well as uncompressed files.</p>
<p>Coordinate data is accessed as linked list of type PDB as follows:</p>
<p>WHOLEPDB *wpdb; PDB *p; wpdb = ReadWholePDB(fp); for(p=wpdb-&gt;pdb; p!=NULL; p=p-&gt;next) { ... Do something with p ... }</p>
<ul>
<li>07.03.07 Made into a wrapper to doReadWholePDB()</li>
<li>07.07.14 Use blDoReadWholePDB() Renamed to <a class="el" href="pdb_8h.html#a56ce69a8cb41874090869c11246e0b0e">blReadWholePDBAtoms()</a> By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l02366">2366</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a10c0ace6d46e2c0a56ce4bea451e76c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a>* blRemoveAlternates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td>
          <td class="paramname"><em>pdb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*pdb</td><td>PDB </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Ammended linked list (in case start has changed)</dd></dl>
<p>Remove alternate atoms - we keep only the highest occupancy or the first if there are more than one the same.</p>
<ul>
<li>25.01.05 Original based on code written for Inpharmatica By: ACRM</li>
<li>04.02.14 Use CHAINMATCH macro. By: CTP</li>
<li>07.07.14 Renamed to <a class="el" href="pdb_8h.html#a10c0ace6d46e2c0a56ce4bea451e76c3">blRemoveAlternates()</a> Use <a class="el" href="pdb_8h.html#ad3bc6ad58dd19e3a2e854404b88b9271">blWritePDBRecord()</a> Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="_read_p_d_b_8c_source.html#l01365">1365</a> of file <a class="el" href="_read_p_d_b_8c_source.html">ReadPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a92e41b535f1505676ed8cbe5896606d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pclose </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a31dd4384020447c7d99d0e4aace6f17a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* popen </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 06:58:47 for Bioplib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
