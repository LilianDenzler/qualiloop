<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Bioplib: /serv/www/html_lilian/bioplib-master/src/HAddPDB.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bioplib
   </div>
   <div id="projectbrief">Protein Structure C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">HAddPDB.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Add hydrogens to a PDB linked list.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_math_type_8h_source.html">MathType.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_sys_defs_8h_source.html">SysDefs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pdb_8h_source.html">pdb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fsscanf_8h_source.html">fsscanf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="general_8h_source.html">general.h</a>&quot;</code><br/>
</div>
<p><a href="_h_add_p_d_b_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afa3b7bd558114ea80d4a13d732b53dde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#afa3b7bd558114ea80d4a13d732b53dde">MAXTYPE</a>&#160;&#160;&#160;300     /* Max number of H definitions in PGP file   */</td></tr>
<tr class="separator:afa3b7bd558114ea80d4a13d732b53dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57ef44e89326a371a47cfd186bf1f6a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a57ef44e89326a371a47cfd186bf1f6a8">MAXLABEL</a>&#160;&#160;&#160;8     /* Max chars in a label                      */</td></tr>
<tr class="separator:a57ef44e89326a371a47cfd186bf1f6a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a0c8dad16ba61ded55d3f302a616c0ced">MAXBUFF</a>&#160;&#160;&#160;160     /* Buffer size                               */</td></tr>
<tr class="separator:a0c8dad16ba61ded55d3f302a616c0ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182088d18407b75db67d5185b9ac0bfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a182088d18407b75db67d5185b9ac0bfa">DATAENV</a>&#160;&#160;&#160;&quot;DATADIR&quot;         /* Unix environment variable for data */</td></tr>
<tr class="separator:a182088d18407b75db67d5185b9ac0bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17897dbbc6ff46c90212d087f60f38c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a17897dbbc6ff46c90212d087f60f38c4">DATADIR</a>&#160;&#160;&#160;&quot;AMDATA:&quot;         /* VMS/AMigaDOS assign for data       */</td></tr>
<tr class="separator:a17897dbbc6ff46c90212d087f60f38c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6251b650e6eba9718806875dd2fdd78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#ab6251b650e6eba9718806875dd2fdd78">EXPLPGP</a>&#160;&#160;&#160;&quot;Explicit.pgp&quot;    /* The PGP filename                   */</td></tr>
<tr class="separator:ab6251b650e6eba9718806875dd2fdd78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad85ca845c3ddf9ed2ad1a1d136193e88"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#ad85ca845c3ddf9ed2ad1a1d136193e88">ALLHPGP</a>&#160;&#160;&#160;&quot;AllH.pgp&quot;        /* The PGP filename                   */</td></tr>
<tr class="separator:ad85ca845c3ddf9ed2ad1a1d136193e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb102327d8ccb3318e08d1cfc853e687"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#adb102327d8ccb3318e08d1cfc853e687">blHAddPDB</a> (FILE *fp, <a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *pdb)</td></tr>
<tr class="separator:adb102327d8ccb3318e08d1cfc853e687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee3ca151f4112a486c688d6ef4293e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#abee3ca151f4112a486c688d6ef4293e8">blReadPGP</a> (FILE *fp)</td></tr>
<tr class="separator:abee3ca151f4112a486c688d6ef4293e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f9337f4b73c4461b9d5a8cb46a9f72"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a57f9337f4b73c4461b9d5a8cb46a9f72">blOpenPGPFile</a> (char *pgpfile, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> AllHyd)</td></tr>
<tr class="separator:a57f9337f4b73c4461b9d5a8cb46a9f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a903434d7cd0b66c8b2e4dff10dc423e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_h_a_d_d_i_n_f_o.html">HADDINFO</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_add_p_d_b_8c.html#a903434d7cd0b66c8b2e4dff10dc423e4">gHaddInfo</a></td></tr>
<tr class="separator:a903434d7cd0b66c8b2e4dff10dc423e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Add hydrogens to a PDB linked list. </p>
<dl class="section version"><dt>Version</dt><dd>V2.24 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13.03.19 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) UCL / Dr. Andrew C. R. Martin 1990-2019 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dr. Andrew C. R. Martin </dd></dl>
<dl class="section user"><dt></dt><dd>Institute of Structural &amp; Molecular Biology, University College London, Gower Street, London. WC1E 6BT. </dd></dl>
<dl class="section user"><dt></dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w@b'+'io'+'inf'+'.o'+'rg.'+'uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w@bi<span style="display: none;">.nosp@m.</span>oinf.<span style="display: none;">.nosp@m.</span>org.<span style="display: none;">.nosp@m.</span>uk</a> <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w.m'+'ar'+'tin'+'@u'+'cl.'+'ac'+'.uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w.ma<span style="display: none;">.nosp@m.</span>rtin@<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a></dd></dl>
<p>This code is NOT IN THE PUBLIC DOMAIN, but it may be copied according to the conditions laid out in the accompanying file COPYING.DOC.</p>
<p>The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.</p>
<p>The code may not be sold commercially or included as part of a commercial product except as described in the file COPYING.DOC.</p>
<h1>Description: </h1>
<p>Routine to add hydrogens to a protein linked list of type PDB. The routine allocates space for the new atoms and inserts them into the list at the appropriate positions within the residues.</p>
<p>N.B. Because of the variation in styles required for N-terminal Hs, this routine adds <em>no</em> hydrogens to the N-terminal residue. FixPDB() may be used for this purpose if CHARMM/CONGEN style hydrogens are required.</p>
<h1>Usage: </h1>
<div class="fragment"><div class="line">nhyd = <a class="code" href="_h_add_p_d_b_8c.html#adb102327d8ccb3318e08d1cfc853e687">blHAddPDB</a>(fp,pdb)</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>File containing proton generation parameters. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*pdb</td><td>Linked list of protein structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of hydrogens added.</dd></dl>
<p>The globally defined structure gHaddInfo gives information on the number of each hydrogen type created. This structure is defined as follows:</p>
<div class="fragment"><div class="line">typdef <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">   <span class="keywordtype">int</span>   Total,      Total hydrogens</div>
<div class="line">         T1,         Type 1 C-H<span class="stringliteral">&#39;s</span></div>
<div class="line"><span class="stringliteral">         T2,         Type 2 C-H2&#39;</span>s</div>
<div class="line">         T3,         Type 3 C-H3<span class="stringliteral">&#39;s</span></div>
<div class="line"><span class="stringliteral">         T4,         Type 4 sp2 C-H&#39;</span>s,&gt;N-H</div>
<div class="line">         T5;         Type 5 O-H<span class="stringliteral">&#39;s =N-H&#39;</span>s</div>
<div class="line">}  <a class="code" href="struct_h_a_d_d_i_n_f_o.html">HADDINFO</a>;</div>
</div><!-- fragment --><p>To examine these values in your code, reference the structure as: extern <a class="el" href="struct_h_a_d_d_i_n_f_o.html">HADDINFO</a> gHaddInfo;</p>
<h1>Revision History: </h1>
<ul>
<li>V2.0 16.05.90 AddH is changed to insert each set of atoms for each PGP, on the fly, rather than building a complete list of hydrogens and then merging the two lists. This allows us to get round the problem of missing atoms, since there will be no merging error.</li>
<li>V2.1 24.05.90 Returns the number fo hydrogens added. Also fixes bug relating to number of type 2 and type 3 H's added. Doesn't work under UNIX!</li>
<li>V2.2 15.07.91 A few bits of tidying up: &gt; Now uses <a class="el" href="macros_8h.html" title="Useful macros. ">macros.h</a> rather than defining macros itself. &gt; Arrays now changed so should fix alignment problems under UNIX. &gt; Now correctly checks return from forscanf() and no longer reads characters to check EOF itself. &gt; Improves treatment of NTER residues where it now generates H's on the first true residue. Residues labelled NTER will be ignored. Calling FixNterH() will move the H coords into the NTER residue if required. &gt; Fixes reading of PGP files with blank lines &gt; Bug fix for type 3's Currently untested under UNIX.</li>
<li>V2.3 27.07.93 Changed to use <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a> and I/O precision is double</li>
<li>V2.4 08.03.94 Changed static variable names and added casts on maths functions. Added Dummy atom handling in makeh(). A few other bits of tidying.</li>
<li>V2.5 23.08.94 Added OpenPGPFile() routine</li>
<li>V2.6 01.09.94 Fixed bug in some compilers in ReadPGP()</li>
<li>V2.7 26.01.96 Wasn't handling insert codes in PDB.</li>
<li>V2.8 24.05.99 Fixed two memory leaks in makeh() Also skips HETATMs in GenH()</li>
<li>V2.9 30.05.02 Changed PDB field from 'junk' to 'record_type'</li>
<li>V2.10 05.12.02 Correctly sets the atnam_raw field</li>
<li>V2.11 27.03.03 Fixed severe memory leak in AddH()</li>
<li>V2.12 03.06.05 Added altpos</li>
<li>V2.13 28.07.05 Added conditionals for msdos and Mac OS/X</li>
<li>V2.14 28.11.05 No longer exits if previous C is missing</li>
<li>V2.15 24.01.06 Fixed error message in GenH() which could try to print from NULL pointer</li>
<li>V2.16 20.03.14 Updated error message in GenH(). By: CTP</li>
<li>V2.17 07.07.14 Use bl prefix for functions By: CTP</li>
<li>V2.18 26.08.14 Moved use of ok variable into #ifdef SCREEN_INFO and cleaned up use of n and nt variables instead of literal strings</li>
<li>V2.19 13.02.15 Handles elements By: ACRM</li>
<li>V2.20 17.02.15 Handles segid and formal charge</li>
<li>V2.21 23.02.15 Uses new <a class="el" href="pdb_8h.html#ae1ff7a56e4d028aef80c0220f59c1358">blRenumAtomsPDB()</a></li>
<li>V2.22 23.06.15 Various calls to <a class="el" href="pdb_8h.html#aa060eecccbc29f0bfbbaf442b42d0cdc">CLEAR_PDB()</a> to fix problems with uninitialized CONECT data</li>
<li>V2.23 07.08.18 initialized and foce-terminated variables to silence gcc 7.3.1 with -O2</li>
<li>V2.24 13.03.19 Fixed buffer sizes for sprintf() </li>
</ul>

<p>Definition in file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad85ca845c3ddf9ed2ad1a1d136193e88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALLHPGP&#160;&#160;&#160;&quot;AllH.pgp&quot;        /* The PGP filename                   */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00180">180</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a17897dbbc6ff46c90212d087f60f38c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATADIR&#160;&#160;&#160;&quot;AMDATA:&quot;         /* VMS/AMigaDOS assign for data       */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00178">178</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a182088d18407b75db67d5185b9ac0bfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATAENV&#160;&#160;&#160;&quot;DATADIR&quot;         /* Unix environment variable for data */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00177">177</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab6251b650e6eba9718806875dd2fdd78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXPLPGP&#160;&#160;&#160;&quot;Explicit.pgp&quot;    /* The PGP filename                   */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00179">179</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0c8dad16ba61ded55d3f302a616c0ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXBUFF&#160;&#160;&#160;160     /* Buffer size                               */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00176">176</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a57ef44e89326a371a47cfd186bf1f6a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXLABEL&#160;&#160;&#160;8     /* Max chars in a label                      */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00175">175</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="afa3b7bd558114ea80d4a13d732b53dde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXTYPE&#160;&#160;&#160;300     /* Max number of H definitions in PGP file   */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00174">174</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="adb102327d8ccb3318e08d1cfc853e687"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int blHAddPDB </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pdb_8h.html#aa31eb9fe57a50b29778e64bb131b22bf">PDB</a> *&#160;</td>
          <td class="paramname"><em>pdb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>File pointer to PGP file </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*pdb</td><td>PDB Linked list to which Hs are added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of Hs added. -1 on error.</dd></dl>
<p>Globals: <a class="el" href="struct_h_a_d_d_i_n_f_o.html">HADDINFO</a> gHaddInfo Information on Hs added</p>
<p>This routine adds hydrogens to a PDB linked list. Performs all necessary functions.</p>
<p>N.B. Because of the variation in styles required for N-terminal Hs, this routine adds <em>no</em> hydrogens to the N-terminal residue. FixPDB() may be used for this purpose if CHARMM/CONGEN style hydrogens are required.</p>
<ul>
<li>16.05.90 Original By: ACRM</li>
<li>04.01.94 Changed check on return=NULL to 0</li>
<li>08.03.94 Only reads PGP on first call. err_flag changed to BOOL.</li>
<li>28.11.05 Removes any dummy hydrogens added because there were missing atoms</li>
<li>07.07.14 Use bl prefix for functions By: CTP</li>
<li>23.02.15 Uses <a class="el" href="pdb_8h.html#ae1ff7a56e4d028aef80c0220f59c1358">blRenumAtomsPDB()</a> By: ACRM</li>
<li>20.03.15 Returns -1 on error since zero hydrogens may be valid </li>
</ul>

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00253">253</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="a57f9337f4b73c4461b9d5a8cb46a9f72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* blOpenPGPFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pgpfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>AllHyd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*pgpfile</td><td>Name of a PGP file or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllHyd</td><td>If name of PGP not specified, this flag specified whether all or explicit hydrogen file required </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>File pointer</dd></dl>
<p>Open the PGP file</p>
<ul>
<li>23.08.94 Original By: ACRM</li>
<li>28.07.05 Added conditionals for msdos and Mac OS/X</li>
<li>07.07.14 Use bl prefix for functions By: CTP</li>
<li>18.03.15 Changed to use MAXBUFF By: ACRM</li>
<li>13.03.19 Doubled size of buffer[] </li>
</ul>

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l01356">1356</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<a class="anchor" id="abee3ca151f4112a486c688d6ef4293e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int blReadPGP </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fp</td><td>Pointer to PGP file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of parameters read. (0 on error)</dd></dl>
<p>Read a proton generation parameter file. All data are placed in static arrays used by the hydrogen adding routines. Normally this routine is only called by the first call to HAddPDB(). It is only necessary to call this routine explicitly if the PGP file is changed between calls to HAddPDB() and thus needs re-reading.</p>
<ul>
<li>16.05.90 Original By: ACRM</li>
<li>27.07.93 Changed to use <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a></li>
<li>01.03.94 Changed static variable names</li>
<li>01.09.94 Moved n++ out of the <a class="el" href="fsscanf_8c.html#aa785b0c5d909efffc6b0a82a79a0ec50">fsscanf()</a></li>
<li>07.07.14 Use bl prefix for functions By: CTP</li>
<li>19.03.15 Skips comments</li>
<li>20.03.15 Returns 0 on error (MAXTYPE exceeded) </li>
</ul>

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00304">304</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a903434d7cd0b66c8b2e4dff10dc423e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_h_a_d_d_i_n_f_o.html">HADDINFO</a> gHaddInfo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_h_add_p_d_b_8c_source.html#l00213">213</a> of file <a class="el" href="_h_add_p_d_b_8c_source.html">HAddPDB.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 06:58:46 for Bioplib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
