<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Bioplib: /serv/www/html_lilian/bioplib-master/src/fit.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bioplib
   </div>
   <div id="projectbrief">Protein Structure C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fit.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Perform least squares fitting of coordinate sets.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_math_type_8h_source.html">MathType.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fit_8h_source.html">fit.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
</div>
<p><a href="fit_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a09c78d2f8feb311dd9fc969a0bf84979"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fit_8c.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>&#160;&#160;&#160;1.0e-20     /* Convergence cutoffs                       */</td></tr>
<tr class="separator:a09c78d2f8feb311dd9fc969a0bf84979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39c421a06ac8891152337c8262623728"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fit_8c.html#a39c421a06ac8891152337c8262623728">SMALSN</a>&#160;&#160;&#160;1.0e-10</td></tr>
<tr class="separator:a39c421a06ac8891152337c8262623728"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a04b6a274d146e9a4b4e3ee014b90d514"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fit_8c.html#a04b6a274d146e9a4b4e3ee014b90d514">blMatfit</a> (<a class="el" href="_math_type_8h.html#abc50014a01227cc91a1efa4c12846fcf">COOR</a> *x1, <a class="el" href="_math_type_8h.html#abc50014a01227cc91a1efa4c12846fcf">COOR</a> *x2, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> rm[3][3], int n, <a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *wt1, <a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> column)</td></tr>
<tr class="separator:a04b6a274d146e9a4b4e3ee014b90d514"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Perform least squares fitting of coordinate sets. </p>
<dl class="section version"><dt>Version</dt><dd>V1.8 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>07.08.18 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) UCL / Dr. Andrew C. R. Martin 1993-2018 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dr. Andrew C. R. Martin </dd></dl>
<dl class="section user"><dt></dt><dd>Institute of Structural &amp; Molecular Biology, University College London, Gower Street, London. WC1E 6BT. </dd></dl>
<dl class="section user"><dt></dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w@b'+'io'+'inf'+'.o'+'rg.'+'uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w@bi<span style="display: none;">.nosp@m.</span>oinf.<span style="display: none;">.nosp@m.</span>org.<span style="display: none;">.nosp@m.</span>uk</a> <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'w.m'+'ar'+'tin'+'@u'+'cl.'+'ac'+'.uk'; return false;">andre<span style="display: none;">.nosp@m.</span>w.ma<span style="display: none;">.nosp@m.</span>rtin@<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a></dd></dl>
<p>This code is NOT IN THE PUBLIC DOMAIN, but it may be copied according to the conditions laid out in the accompanying file COPYING.DOC.</p>
<p>The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.</p>
<p>The code may not be sold commercially or included as part of a commercial product except as described in the file COPYING.DOC.</p>
<h1>Description: </h1>
<p>This code performs least squares fitting of two coordinate set using the method of McLachlan as modified by Sutcliffe.</p>
<h1>Usage: </h1>
<p>Passed two coordinate arrays both centred around the origin and, optionally, an array of weights, returns a rotation matrix.</p>
<h1>Revision History: </h1>
<ul>
<li>V1.0 04.02.91 Original</li>
<li>V1.1 01.06.92 ANSIed and static'd</li>
<li>V1.2 08.12.92 Changed abs() to <a class="el" href="macros_8h.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS()</a> using <a class="el" href="macros_8h.html" title="Useful macros. ">macros.h</a>. Includes stdio.h</li>
<li>V1.3 11.02.94 Changed column flag to BOOL</li>
<li>V1.4 03.06.97 Corrected documentation</li>
<li>V1.5 03.04.09 Initialize clep in qikfit() By: CTP</li>
<li>V1.6 07.07.14 Use bl prefix for functions By: CTP</li>
<li>V1.7 17.07.14 Removed unused varables By: ACRM</li>
<li>V1.8 07.08.18 Initialized step[] to silence gcc 7.3.1 with -O2 </li>
</ul>

<p>Definition in file <a class="el" href="fit_8c_source.html">fit.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a09c78d2f8feb311dd9fc969a0bf84979"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMALL&#160;&#160;&#160;1.0e-20     /* Convergence cutoffs                       */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fit_8c_source.html#l00087">87</a> of file <a class="el" href="fit_8c_source.html">fit.c</a>.</p>

</div>
</div>
<a class="anchor" id="a39c421a06ac8891152337c8262623728"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMALSN&#160;&#160;&#160;1.0e-10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="fit_8c_source.html#l00088">88</a> of file <a class="el" href="fit_8c_source.html">fit.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a04b6a274d146e9a4b4e3ee014b90d514"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a> blMatfit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#abc50014a01227cc91a1efa4c12846fcf">COOR</a> *&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#abc50014a01227cc91a1efa4c12846fcf">COOR</a> *&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a>&#160;</td>
          <td class="paramname"><em>rm</em>[3][3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_math_type_8h.html#a5821460e95a0800cf9f24c38915cbbde">REAL</a> *&#160;</td>
          <td class="paramname"><em>wt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_sys_defs_8h.html#a2df9d82ef74025dde989a5ae3edc886c">BOOL</a>&#160;</td>
          <td class="paramname"><em>column</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*x1</td><td>First (fixed) array of coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*x2</td><td>Second (mobile) array of coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*wt1</td><td>Weight array or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">column</td><td>TRUE: Output a column-wise matrix (as used by FRODO) FALSE: Output a standard row-wise matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rm</td><td>Returned rotation matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE: success FALSE: error</dd></dl>
<p>Fit coordinate array x2 to x1 both centred around the origin and of length n. Optionally weighted with the wt1 array if wt1 is not NULL. If column is set the matrix will be returned column-wise rather than row-wise.</p>
<ul>
<li>04.02.91 Original based on code by Mike Sutcliffe</li>
<li>01.06.92 ANSIed &amp; doc'd</li>
<li>17.06.93 various changes for release (including parameters)</li>
<li>11.03.94 column changed to BOOL</li>
<li>25.11.02 Corrected header!</li>
<li>07.07.14 Use bl prefix for functions By: CTP </li>
</ul>

<p>Definition at line <a class="el" href="fit_8c_source.html#l00129">129</a> of file <a class="el" href="fit_8c_source.html">fit.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 06:58:46 for Bioplib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
