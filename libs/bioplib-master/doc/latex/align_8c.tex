\hypertarget{align_8c}{\section{/serv/www/html\-\_\-lilian/bioplib-\/master/src/align.c File Reference}
\label{align_8c}\index{/serv/www/html\-\_\-lilian/bioplib-\/master/src/align.\-c@{/serv/www/html\-\_\-lilian/bioplib-\/master/src/align.\-c}}
}


Perform Needleman \& Wunsch sequence alignment.  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$ctype.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Sys\-Defs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}macros.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}array.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}general.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}seq.\-h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_x_y}{X\-Y}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{align_8c_afe71f6c475faba7bc84bc73e239bf567}{M\-A\-X3}(c, d, e)~(\hyperlink{macros_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{M\-A\-X}(\hyperlink{macros_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{M\-A\-X}((c),(d)),(e)))
\item 
\#define \hyperlink{align_8c_a182088d18407b75db67d5185b9ac0bfa}{D\-A\-T\-A\-E\-N\-V}~\char`\"{}D\-A\-T\-A\-D\-I\-R\char`\"{}   /$\ast$ Environment variable or assign           $\ast$/
\item 
\#define \hyperlink{align_8c_a0c8dad16ba61ded55d3f302a616c0ced}{M\-A\-X\-B\-U\-F\-F}~400
\item 
\#define \hyperlink{align_8c_abdf813ae969421add7c4be8f806be018}{M\-A\-X\-W\-O\-R\-D}~16
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{align_8c_ad4440404ba000b804b8e5bdbf5144296}{bl\-Align} (char $\ast$seq1, int length1, char $\ast$seq2, int length2, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} verbose, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} identity, int penalty, char $\ast$align1, char $\ast$align2, int $\ast$align\-\_\-len)
\item 
int \hyperlink{align_8c_a2bfda833cbb45aa99d853f90b0a8c3e6}{bl\-Affinealign} (char $\ast$seq1, int length1, char $\ast$seq2, int length2, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} verbose, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} identity, int penalty, int penext, char $\ast$align1, char $\ast$align2, int $\ast$align\-\_\-len)
\item 
int \hyperlink{align_8c_a202550fea7f22fad1fa8bcd23aa736b3}{bl\-Affinealignuc} (char $\ast$seq1, int length1, char $\ast$seq2, int length2, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} verbose, \hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} identity, int penalty, int penext, char $\ast$align1, char $\ast$align2, int $\ast$align\-\_\-len)
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{align_8c_a7427990ccc2bc14bf3e1a1797a1aaba7}{bl\-Read\-M\-D\-M} (char $\ast$mdmfile)
\item 
void \hyperlink{align_8c_a6ff80e0085ce2af58bdbdfbefa887749}{bl\-Free\-M\-D\-M} (void)
\item 
int \hyperlink{align_8c_a503439e6489823462c1c4c242ccc47e0}{bl\-Calc\-M\-D\-M\-Score} (char resa, char resb)
\item 
int \hyperlink{align_8c_ad4bd60d9e34a3ac0d408508be92f4c83}{bl\-Calc\-M\-D\-M\-Score\-U\-C} (char resa, char resb)
\item 
int \hyperlink{align_8c_ad774c0d240bcf9902340a66c2336658e}{bl\-Zero\-M\-D\-M} (void)
\item 
void \hyperlink{align_8c_a543c1d8afe579c1d3ebf03c4522f8554}{bl\-Set\-M\-D\-M\-Score\-Weight} (char resa, char resb, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} weight)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Perform Needleman \& Wunsch sequence alignment. \begin{DoxyVersion}{Version}
V3.\-7 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
02.\-05.\-18 
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
(c) U\-C\-L / Dr. Andrew C. R. Martin 1993-\/2018 
\end{DoxyCopyright}
\begin{DoxyAuthor}{Author}
Dr. Andrew C. R. Martin 
\end{DoxyAuthor}
\begin{DoxyParagraph}{}
Institute of Structural \& Molecular Biology, University College London, Gower Street, London. W\-C1\-E 6\-B\-T. 
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
\href{mailto:andrew@bioinf.org.uk}{\tt andrew@bioinf.\-org.\-uk} \href{mailto:andrew.martin@ucl.ac.uk}{\tt andrew.\-martin@ucl.\-ac.\-uk}
\end{DoxyParagraph}
This code is N\-O\-T I\-N T\-H\-E P\-U\-B\-L\-I\-C D\-O\-M\-A\-I\-N, but it may be copied according to the conditions laid out in the accompanying file C\-O\-P\-Y\-I\-N\-G.\-D\-O\-C.

The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.

The code may not be sold commercially or included as part of a commercial product except as described in the file C\-O\-P\-Y\-I\-N\-G.\-D\-O\-C.

\subsection*{Description\-: }

A simple Needleman \& Wunsch Dynamic Programming alignment of 2 sequences.

A window is not used so the routine may be a bit slow on long sequences.

\subsection*{Usage\-: }

First call Read\-M\-D\-M() to read the mutation data matrix, then call align() to align the sequences.

\subsection*{Revision History\-: }


\begin{DoxyItemize}
\item V1.\-0 19.\-06.\-90 Original used in N\-W program
\item V2.\-0 07.\-10.\-92 Original extracted from old N\-W program
\item V2.\-1 16.\-06.\-93 Tidied for book
\item V2.\-2 01.\-03.\-94 Changed static variable names
\item V2.\-3 18.\-03.\-94 getc() -\/$>$ fgetc()
\item V2.\-4 24.\-11.\-94 Read\-M\-D\-M() now looks after searching D\-A\-T\-A\-D\-I\-R
\item V2.\-5 28.\-02.\-95 Read\-M\-D\-M() and other code improved to cope with M\-D\-Ms of any size
\item V2.\-6 26.\-07.\-95 Removed unused variables
\item V2.\-7 21.\-08.\-95 Initialisation of matrix was incorrect leading to errors at the end of the alignment.
\item V2.\-8 24.\-08.\-95 calcscore() was doing an out-\/of-\/bounds array reference if a character wasn't found
\item V2.\-9 11.\-07.\-96 calcscore() changed to Calc\-M\-D\-M\-Score() and made non-\/static
\item V2.\-10 09.\-09.\-96 Improved comments for Read\-M\-D\-M()
\item V2.\-11 17.\-09.\-96 Added Zero\-M\-D\-M()
\item V3.\-0 06.\-03.\-00 Traceback code rewritten to use a trace matrix created while the main matrix is populated. New affinealign() routine implemented. align() is now a wrapper to that.
\item V3.\-1 06.\-02.\-03 Fixed for new version of Get\-Word()
\item V3.\-2 27.\-02.\-07 Added affinealineuc() and Calc\-M\-D\-M\-Score\-U\-C()
\item V3.\-3 07.\-04.\-09 Complete re-\/write of Read\-M\-D\-M() so it can read B\-L\-A\-S\-T style matrix files as well as our own
\item V3.\-4 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\item V3.\-5 26.\-08.\-14 Added \hyperlink{align_8c_a543c1d8afe579c1d3ebf03c4522f8554}{bl\-Set\-M\-D\-M\-Score\-Weight()} By\-: A\-C\-R\-M
\item V3.\-6 04.\-01.\-16 Added special calls to \hyperlink{align_8c_a503439e6489823462c1c4c242ccc47e0}{bl\-Calc\-M\-D\-M\-Score()} and \hyperlink{align_8c_ad4bd60d9e34a3ac0d408508be92f4c83}{bl\-Calc\-M\-D\-M\-Score\-U\-C()} to silence warnings. Warnings now go to stderr
\item V3.\-7 02.\-05.\-18 Added \hyperlink{align_8c_a6ff80e0085ce2af58bdbdfbefa887749}{bl\-Free\-M\-D\-M()} 
\end{DoxyItemize}

Definition in file \hyperlink{align_8c_source}{align.\-c}.



\subsection{Macro Definition Documentation}
\hypertarget{align_8c_a182088d18407b75db67d5185b9ac0bfa}{\index{align.\-c@{align.\-c}!D\-A\-T\-A\-E\-N\-V@{D\-A\-T\-A\-E\-N\-V}}
\index{D\-A\-T\-A\-E\-N\-V@{D\-A\-T\-A\-E\-N\-V}!align.c@{align.\-c}}
\subsubsection[{D\-A\-T\-A\-E\-N\-V}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-A\-T\-A\-E\-N\-V~\char`\"{}D\-A\-T\-A\-D\-I\-R\char`\"{}   /$\ast$ Environment variable or assign           $\ast$/}}\label{align_8c_a182088d18407b75db67d5185b9ac0bfa}


Definition at line 153 of file align.\-c.

\hypertarget{align_8c_afe71f6c475faba7bc84bc73e239bf567}{\index{align.\-c@{align.\-c}!M\-A\-X3@{M\-A\-X3}}
\index{M\-A\-X3@{M\-A\-X3}!align.c@{align.\-c}}
\subsubsection[{M\-A\-X3}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X3(
\begin{DoxyParamCaption}
\item[{}]{c, }
\item[{}]{d, }
\item[{}]{e}
\end{DoxyParamCaption}
)~({\bf M\-A\-X}({\bf M\-A\-X}((c),(d)),(e)))}}\label{align_8c_afe71f6c475faba7bc84bc73e239bf567}


Definition at line 151 of file align.\-c.

\hypertarget{align_8c_a0c8dad16ba61ded55d3f302a616c0ced}{\index{align.\-c@{align.\-c}!M\-A\-X\-B\-U\-F\-F@{M\-A\-X\-B\-U\-F\-F}}
\index{M\-A\-X\-B\-U\-F\-F@{M\-A\-X\-B\-U\-F\-F}!align.c@{align.\-c}}
\subsubsection[{M\-A\-X\-B\-U\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X\-B\-U\-F\-F~400}}\label{align_8c_a0c8dad16ba61ded55d3f302a616c0ced}


Definition at line 155 of file align.\-c.

\hypertarget{align_8c_abdf813ae969421add7c4be8f806be018}{\index{align.\-c@{align.\-c}!M\-A\-X\-W\-O\-R\-D@{M\-A\-X\-W\-O\-R\-D}}
\index{M\-A\-X\-W\-O\-R\-D@{M\-A\-X\-W\-O\-R\-D}!align.c@{align.\-c}}
\subsubsection[{M\-A\-X\-W\-O\-R\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X\-W\-O\-R\-D~16}}\label{align_8c_abdf813ae969421add7c4be8f806be018}


Definition at line 156 of file align.\-c.



\subsection{Function Documentation}
\hypertarget{align_8c_a2bfda833cbb45aa99d853f90b0a8c3e6}{\index{align.\-c@{align.\-c}!bl\-Affinealign@{bl\-Affinealign}}
\index{bl\-Affinealign@{bl\-Affinealign}!align.c@{align.\-c}}
\subsubsection[{bl\-Affinealign}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Affinealign (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{seq1, }
\item[{int}]{length1, }
\item[{char $\ast$}]{seq2, }
\item[{int}]{length2, }
\item[{{\bf B\-O\-O\-L}}]{verbose, }
\item[{{\bf B\-O\-O\-L}}]{identity, }
\item[{int}]{penalty, }
\item[{int}]{penext, }
\item[{char $\ast$}]{align1, }
\item[{char $\ast$}]{align2, }
\item[{int $\ast$}]{align\-\_\-len}
\end{DoxyParamCaption}
)}}\label{align_8c_a2bfda833cbb45aa99d853f90b0a8c3e6}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$seq1} & First sequence \\
\hline
\mbox{\tt in}  & {\em length1} & First sequence length \\
\hline
\mbox{\tt in}  & {\em $\ast$seq2} & Second sequence \\
\hline
\mbox{\tt in}  & {\em length2} & Second sequence length \\
\hline
\mbox{\tt in}  & {\em verbose} & Display N\&W matrix \\
\hline
\mbox{\tt in}  & {\em identity} & Use identity matrix \\
\hline
\mbox{\tt in}  & {\em penalty} & Gap insertion penalty value \\
\hline
\mbox{\tt in}  & {\em penext} & Extension penalty \\
\hline
\mbox{\tt out}  & {\em $\ast$align1} & Sequence 1 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align2} & Sequence 2 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align\-\_\-len} & Alignment length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alignment score (0 on error)
\end{DoxyReturn}
Perform simple N\&W alignment of seq1 and seq2. No window is used, so will be slow for long sequences.

Note that you must allocate sufficient memory for the aligned sequences. The easy way to do this is to ensure that align1 and align2 are of length (length1+length2).


\begin{DoxyItemize}
\item 07.\-10.\-92 Adapted from original written while at N\-I\-M\-R
\item 08.\-10.\-92 Split into separate routines
\item 09.\-10.\-92 Changed best structure to simple integers, moved Search\-For\-Best() into Trace\-Back()
\item 21.\-08.\-95 Was only filling in the bottom right cell at initialisation rather than all the right hand column and bottom row
\item 11.\-07.\-96 Changed calls to calcscore() to Calc\-M\-D\-M\-Score()
\item 06.\-03.\-00 Changed name to affinealign() (the routine align() is provided as a backwards compatible wrapper). Added penext parameter. Now supports affine gap penalties with separate opening and extension penalties. The code now maintains the path as it goes.
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P \begin{DoxyVerb}  NOTE AND CHANGES SHOULD BE PROPAGATED TO affinealignuc()   ******\end{DoxyVerb}
 
\end{DoxyItemize}

Definition at line 280 of file align.\-c.

\hypertarget{align_8c_a202550fea7f22fad1fa8bcd23aa736b3}{\index{align.\-c@{align.\-c}!bl\-Affinealignuc@{bl\-Affinealignuc}}
\index{bl\-Affinealignuc@{bl\-Affinealignuc}!align.c@{align.\-c}}
\subsubsection[{bl\-Affinealignuc}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Affinealignuc (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{seq1, }
\item[{int}]{length1, }
\item[{char $\ast$}]{seq2, }
\item[{int}]{length2, }
\item[{{\bf B\-O\-O\-L}}]{verbose, }
\item[{{\bf B\-O\-O\-L}}]{identity, }
\item[{int}]{penalty, }
\item[{int}]{penext, }
\item[{char $\ast$}]{align1, }
\item[{char $\ast$}]{align2, }
\item[{int $\ast$}]{align\-\_\-len}
\end{DoxyParamCaption}
)}}\label{align_8c_a202550fea7f22fad1fa8bcd23aa736b3}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$seq1} & First sequence \\
\hline
\mbox{\tt in}  & {\em length1} & First sequence length \\
\hline
\mbox{\tt in}  & {\em $\ast$seq2} & Second sequence \\
\hline
\mbox{\tt in}  & {\em length2} & Second sequence length \\
\hline
\mbox{\tt in}  & {\em verbose} & Display N\&W matrix \\
\hline
\mbox{\tt in}  & {\em identity} & Use identity matrix \\
\hline
\mbox{\tt in}  & {\em penalty} & Gap insertion penalty value \\
\hline
\mbox{\tt in}  & {\em penext} & Extension penalty \\
\hline
\mbox{\tt out}  & {\em $\ast$align1} & Sequence 1 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align2} & Sequence 2 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align\-\_\-len} & Alignment length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alignment score (0 on error)
\end{DoxyReturn}
Perform simple N\&W alignment of seq1 and seq2. No window is used, so will be slow for long sequences.

Note that you must allocate sufficient memory for the aligned sequences. The easy way to do this is to ensure that align1 and align2 are of length (length1+length2).


\begin{DoxyItemize}
\item 07.\-10.\-92 Adapted from original written while at N\-I\-M\-R
\item 08.\-10.\-92 Split into separate routines
\item 09.\-10.\-92 Changed best structure to simple integers, moved Search\-For\-Best() into Trace\-Back()
\item 21.\-08.\-95 Was only filling in the bottom right cell at initialisation rather than all the right hand column and bottom row
\item 11.\-07.\-96 Changed calls to calcscore() to Calc\-M\-D\-M\-Score()
\item 06.\-03.\-00 Changed name to affinealign() (the routine align() is provided as a backwards compatible wrapper). Added penext parameter. Now supports affine gap penalties with separate opening and extension penalties. The code now maintains the path as it goes.
\item 27.\-02.\-07 Exactly as affinealign() but upcases characters before comparison
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\end{DoxyItemize}

\begin{DoxyVerb}      NOTE AND CHANGES SHOULD BE PROPAGATED TO affinealign()    ******\end{DoxyVerb}
 

Definition at line 588 of file align.\-c.

\hypertarget{align_8c_ad4440404ba000b804b8e5bdbf5144296}{\index{align.\-c@{align.\-c}!bl\-Align@{bl\-Align}}
\index{bl\-Align@{bl\-Align}!align.c@{align.\-c}}
\subsubsection[{bl\-Align}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Align (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{seq1, }
\item[{int}]{length1, }
\item[{char $\ast$}]{seq2, }
\item[{int}]{length2, }
\item[{{\bf B\-O\-O\-L}}]{verbose, }
\item[{{\bf B\-O\-O\-L}}]{identity, }
\item[{int}]{penalty, }
\item[{char $\ast$}]{align1, }
\item[{char $\ast$}]{align2, }
\item[{int $\ast$}]{align\-\_\-len}
\end{DoxyParamCaption}
)}}\label{align_8c_ad4440404ba000b804b8e5bdbf5144296}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$seq1} & First sequence \\
\hline
\mbox{\tt in}  & {\em length1} & First sequence length \\
\hline
\mbox{\tt in}  & {\em $\ast$seq2} & Second sequence \\
\hline
\mbox{\tt in}  & {\em length2} & Second sequence length \\
\hline
\mbox{\tt in}  & {\em verbose} & Display N\&W matrix \\
\hline
\mbox{\tt in}  & {\em identity} & Use identity matrix \\
\hline
\mbox{\tt in}  & {\em penalty} & Gap insertion penalty value \\
\hline
\mbox{\tt out}  & {\em $\ast$align1} & Sequence 1 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align2} & Sequence 2 aligned \\
\hline
\mbox{\tt out}  & {\em $\ast$align\-\_\-len} & Alignment length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alignment score (0 on error)
\end{DoxyReturn}
Perform simple N\&W alignment of seq1 and seq2. No window is used, so will be slow for long sequences.

A single gap penalty is used, so gap extension incurrs no further penalty.

Note that you must allocate sufficient memory for the aligned sequences. The easy way to do this is to ensure that align1 and align2 are of length (length1+length2).


\begin{DoxyItemize}
\item 06.\-03.\-00 Implemented as a wrapper to affinealign() which is the old align() routine, plus support for affine gap penalties, plus new traceback code based on storing the path as we go
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 219 of file align.\-c.

\hypertarget{align_8c_a503439e6489823462c1c4c242ccc47e0}{\index{align.\-c@{align.\-c}!bl\-Calc\-M\-D\-M\-Score@{bl\-Calc\-M\-D\-M\-Score}}
\index{bl\-Calc\-M\-D\-M\-Score@{bl\-Calc\-M\-D\-M\-Score}!align.c@{align.\-c}}
\subsubsection[{bl\-Calc\-M\-D\-M\-Score}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Calc\-M\-D\-M\-Score (
\begin{DoxyParamCaption}
\item[{char}]{resa, }
\item[{char}]{resb}
\end{DoxyParamCaption}
)}}\label{align_8c_a503439e6489823462c1c4c242ccc47e0}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em resa} & First residue \\
\hline
\mbox{\tt in}  & {\em resb} & Second residue \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
score
\end{DoxyReturn}
Calculate score from static globally stored mutation data matrix

If both residues are set as '\textbackslash{}0' it will simply silence all warnings


\begin{DoxyItemize}
\item 07.\-10.\-92 Adapted from N\-I\-M\-R-\/written original
\item 24.\-11.\-94 Only gives 10 warnings
\item 28.\-02.\-95 Modified to use s\-M\-D\-M\-Size
\item 24.\-08.\-95 If a residue was not found was doing an out-\/of-\/bounds array reference causing a potential core dump
\item 11.\-07.\-96 Name changed from calcscore() and now non-\/static
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\item 04.\-01.\-16 Added special call with both residues set to '\textbackslash{}0' to silence warnings. Also warnings now go to stderr 
\end{DoxyItemize}

Definition at line 1241 of file align.\-c.

\hypertarget{align_8c_ad4bd60d9e34a3ac0d408508be92f4c83}{\index{align.\-c@{align.\-c}!bl\-Calc\-M\-D\-M\-Score\-U\-C@{bl\-Calc\-M\-D\-M\-Score\-U\-C}}
\index{bl\-Calc\-M\-D\-M\-Score\-U\-C@{bl\-Calc\-M\-D\-M\-Score\-U\-C}!align.c@{align.\-c}}
\subsubsection[{bl\-Calc\-M\-D\-M\-Score\-U\-C}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Calc\-M\-D\-M\-Score\-U\-C (
\begin{DoxyParamCaption}
\item[{char}]{resa, }
\item[{char}]{resb}
\end{DoxyParamCaption}
)}}\label{align_8c_ad4bd60d9e34a3ac0d408508be92f4c83}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em resa} & First residue \\
\hline
\mbox{\tt in}  & {\em resb} & Second residue \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
score
\end{DoxyReturn}
Calculate score from static globally stored mutation data matrix


\begin{DoxyItemize}
\item 07.\-10.\-92 Adapted from N\-I\-M\-R-\/written original
\item 24.\-11.\-94 Only gives 10 warnings
\item 28.\-02.\-95 Modified to use s\-M\-D\-M\-Size
\item 24.\-08.\-95 If a residue was not found was doing an out-\/of-\/bounds array reference causing a potential core dump
\item 11.\-07.\-96 Name changed from calcscore() and now non-\/static
\item 27.\-02.\-07 As Calc\-M\-D\-M\-Score() but upcases characters before comparison
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\item 04.\-01.\-16 Added special call with both residues set to '\textbackslash{}0' to silence warnings. Also warnings now go to stderr 
\end{DoxyItemize}

Definition at line 1314 of file align.\-c.

\hypertarget{align_8c_a6ff80e0085ce2af58bdbdfbefa887749}{\index{align.\-c@{align.\-c}!bl\-Free\-M\-D\-M@{bl\-Free\-M\-D\-M}}
\index{bl\-Free\-M\-D\-M@{bl\-Free\-M\-D\-M}!align.c@{align.\-c}}
\subsubsection[{bl\-Free\-M\-D\-M}]{\setlength{\rightskip}{0pt plus 5cm}void bl\-Free\-M\-D\-M (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{align_8c_a6ff80e0085ce2af58bdbdfbefa887749}
Frees the memory allocated by \hyperlink{align_8c_a7427990ccc2bc14bf3e1a1797a1aaba7}{bl\-Read\-M\-D\-M()}


\begin{DoxyItemize}
\item 02.\-05.\-18 Original By\-: A\-C\-R\-M 
\end{DoxyItemize}

Definition at line 1012 of file align.\-c.

\hypertarget{align_8c_a7427990ccc2bc14bf3e1a1797a1aaba7}{\index{align.\-c@{align.\-c}!bl\-Read\-M\-D\-M@{bl\-Read\-M\-D\-M}}
\index{bl\-Read\-M\-D\-M@{bl\-Read\-M\-D\-M}!align.c@{align.\-c}}
\subsubsection[{bl\-Read\-M\-D\-M}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Read\-M\-D\-M (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{mdmfile}
\end{DoxyParamCaption}
)}}\label{align_8c_a7427990ccc2bc14bf3e1a1797a1aaba7}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$mdmfile} & Mutation data matrix filename \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Success?
\end{DoxyReturn}
Read mutation data matrix into static global arrays. The matrix may have comments at the start introduced with a ! in the first column. The matrix must be complete (i.\-e. a triangular matrix will not work). A line describing the residue types must appear, and may be placed before or after the matrix itself


\begin{DoxyItemize}
\item 07.\-10.\-92 Original
\item 18.\-03.\-94 getc() -\/$>$ fgetc()
\item 24.\-11.\-94 Automatically looks in D\-A\-T\-A\-E\-N\-V if not found in current directory
\item 28.\-02.\-95 Modified to read any size M\-D\-M and allow comments Also allows the list of aa types before or after the actual matrix
\item 26.\-07.\-95 Removed unused variables
\item 06.\-02.\-03 Fixed for new version of Get\-Word()
\item 07.\-04.\-09 Completely re-\/written to allow it to read B\-L\-A\-S\-T style matrix files as well as the ones used previously Allow comments introduced with \# as well as ! Uses M\-A\-X\-W\-O\-R\-D rather than hardcoded 16
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 876 of file align.\-c.

\hypertarget{align_8c_a543c1d8afe579c1d3ebf03c4522f8554}{\index{align.\-c@{align.\-c}!bl\-Set\-M\-D\-M\-Score\-Weight@{bl\-Set\-M\-D\-M\-Score\-Weight}}
\index{bl\-Set\-M\-D\-M\-Score\-Weight@{bl\-Set\-M\-D\-M\-Score\-Weight}!align.c@{align.\-c}}
\subsubsection[{bl\-Set\-M\-D\-M\-Score\-Weight}]{\setlength{\rightskip}{0pt plus 5cm}void bl\-Set\-M\-D\-M\-Score\-Weight (
\begin{DoxyParamCaption}
\item[{char}]{resa, }
\item[{char}]{resb, }
\item[{{\bf R\-E\-A\-L}}]{weight}
\end{DoxyParamCaption}
)}}\label{align_8c_a543c1d8afe579c1d3ebf03c4522f8554}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em resa} & First residue \\
\hline
\mbox{\tt in}  & {\em resb} & Second residue \\
\hline
\mbox{\tt in}  & {\em weight} & Weight to apply\\
\hline
\end{DoxyParams}
Apply a weight to a particular amino acid substitution


\begin{DoxyItemize}
\item 26.\-08.\-14 Original By\-: A\-C\-R\-M 
\end{DoxyItemize}

Definition at line 1429 of file align.\-c.

\hypertarget{align_8c_ad774c0d240bcf9902340a66c2336658e}{\index{align.\-c@{align.\-c}!bl\-Zero\-M\-D\-M@{bl\-Zero\-M\-D\-M}}
\index{bl\-Zero\-M\-D\-M@{bl\-Zero\-M\-D\-M}!align.c@{align.\-c}}
\subsubsection[{bl\-Zero\-M\-D\-M}]{\setlength{\rightskip}{0pt plus 5cm}int bl\-Zero\-M\-D\-M (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{align_8c_ad774c0d240bcf9902340a66c2336658e}
\begin{DoxyReturn}{Returns}
Maximum value in modified matrix
\end{DoxyReturn}
Modifies all values in the M\-D\-M such that the minimum value is 0
\begin{DoxyItemize}
\item 17.\-09.\-96 Original
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 1379 of file align.\-c.

