\hypertarget{_resol_p_d_b_8c}{\section{/serv/www/html\-\_\-lilian/bioplib-\/master/src/\-Resol\-P\-D\-B.c File Reference}
\label{_resol_p_d_b_8c}\index{/serv/www/html\-\_\-lilian/bioplib-\/master/src/\-Resol\-P\-D\-B.\-c@{/serv/www/html\-\_\-lilian/bioplib-\/master/src/\-Resol\-P\-D\-B.\-c}}
}


Get resolution and R-\/factor information out of a P\-D\-B file.  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}pdb.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}macros.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_resol_p_d_b_8c_a0c8dad16ba61ded55d3f302a616c0ced}{M\-A\-X\-B\-U\-F\-F}~160
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{_resol_p_d_b_8c_a35c8f98e52940966707d8004ed8a5826}{bl\-Get\-Resol\-P\-D\-B} (F\-I\-L\-E $\ast$fp, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$resolution, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$R\-Factor, int $\ast$Struc\-Type)
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{_resol_p_d_b_8c_a4d5b4d6154f9efed0b1bf00dcb5aa16b}{bl\-Get\-Resol\-Whole\-P\-D\-B} (\hyperlink{pdb_8h_af81d935f76d79bf5a92ed72a1db6ebd8}{W\-H\-O\-L\-E\-P\-D\-B} $\ast$wpdb, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$resolution, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$R\-Factor, int $\ast$Struc\-Type)
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{_resol_p_d_b_8c_a80f6538fb3e9116b484a44993c62a1a6}{bl\-Get\-Exptl\-P\-D\-B} (F\-I\-L\-E $\ast$fp, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$resolution, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$R\-Factor, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$Free\-R, int $\ast$Struc\-Type)
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{_resol_p_d_b_8c_ae30274ef986cfdd010792451a61ae96b}{bl\-Get\-Exptl\-Whole\-P\-D\-B} (\hyperlink{pdb_8h_af81d935f76d79bf5a92ed72a1db6ebd8}{W\-H\-O\-L\-E\-P\-D\-B} $\ast$wpdb, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$resolution, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$R\-Factor, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$Free\-R, int $\ast$Struc\-Type)
\item 
char $\ast$ \hyperlink{_resol_p_d_b_8c_a570868c653dcba07ecddf06b1a15c4b2}{bl\-Report\-Structure\-Type} (int Struc\-Type)
\item 
\hyperlink{_sys_defs_8h_a2df9d82ef74025dde989a5ae3edc886c}{B\-O\-O\-L} \hyperlink{_resol_p_d_b_8c_a09f6999081df2204ee322f785319282e}{bl\-Get\-Exptl\-Old} (F\-I\-L\-E $\ast$fp, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$resolution, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$R\-Factor, \hyperlink{_math_type_8h_a5821460e95a0800cf9f24c38915cbbde}{R\-E\-A\-L} $\ast$Free\-R, int $\ast$Struc\-Type)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Get resolution and R-\/factor information out of a P\-D\-B file. \begin{DoxyVersion}{Version}
V1.\-8 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
07.\-07.\-14 
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
(c) U\-C\-L / Dr. Andrew C.\-R. Martin, 1994-\/2014 
\end{DoxyCopyright}
\begin{DoxyAuthor}{Author}
Dr. Andrew C. R. Martin 
\end{DoxyAuthor}
\begin{DoxyParagraph}{}
Institute of Structural \& Molecular Biology, University College London, Gower Street, London. W\-C1\-E 6\-B\-T. 
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
\href{mailto:andrew@bioinf.org.uk}{\tt andrew@bioinf.\-org.\-uk} \href{mailto:andrew.martin@ucl.ac.uk}{\tt andrew.\-martin@ucl.\-ac.\-uk}
\end{DoxyParagraph}
This code is N\-O\-T I\-N T\-H\-E P\-U\-B\-L\-I\-C D\-O\-M\-A\-I\-N, but it may be copied according to the conditions laid out in the accompanying file C\-O\-P\-Y\-I\-N\-G.\-D\-O\-C.

The code may be modified as required, but any modifications must be documented so that the person responsible can be identified.

The code may not be sold commercially or included as part of a commercial product except as described in the file C\-O\-P\-Y\-I\-N\-G.\-D\-O\-C.

\subsection*{Description\-: }

\subsection*{Usage\-: }

See documentation for details

\subsection*{Revision History\-: }


\begin{DoxyItemize}
\item V1.\-0 28.\-02.\-94 Original
\item V1.\-1 18.\-03.\-94 Removed extraneous printf() statement
\item V1.\-2 17.\-07.\-96 Added check for E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E \-: T\-H\-E\-O\-R\-E\-T\-I\-C\-A\-L M\-O\-D\-E\-L Fixed bug in searching for M\-O\-D\-E\-L or N\-M\-R info
\item V1.\-3 27.\-06.\-97 Added handing of R\-E\-S\-O\-L\-U\-T\-I\-O\-N records which point you to another record for the experiment type. Fixed E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E to look for N\-M\-R as well Looks for E\-X\-P\-D\-T\-A N\-M\-R record
\item V1.\-4 23.\-03.\-98 Added check that R\-E\-S\-O\-L\-U\-T\-I\-O\-N record is in a R\-E\-M\-A\-R\-K 2
\item V1.\-5 08.\-02.\-99 Get\-Resol\-P\-D\-B() now a wrapper to Get\-Exptl() which now parses structured R\-E\-M\-A\-R\-K3 blocks and also returns the Free R. Initialise some variables to 0.\-0
\item V1.\-6 30.\-05.\-02 Incorporated changes from Inpharmatica -\/ now finds Electron diffraction as an experimental type. Handles files without R\-E\-M\-A\-R\-K 2 correctly
\item V1.\-7 13.\-12.\-12 Complete re-\/implementation of Get\-Exptl() for remediated P\-D\-B files. Old version for old P\-D\-B files available as Get\-Exptl\-Old()
\item V1.\-8 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\item V1.\-9 02.\-03.\-15 Renamed bl\-Get\-Exptl() to \hyperlink{pdb_8h_a80f6538fb3e9116b484a44993c62a1a6}{bl\-Get\-Exptl\-P\-D\-B()} Moved Read\-Data() out from \hyperlink{pdb_8h_a80f6538fb3e9116b484a44993c62a1a6}{bl\-Get\-Exptl\-P\-D\-B()} Added \hyperlink{pdb_8h_ae30274ef986cfdd010792451a61ae96b}{bl\-Get\-Exptl\-Whole\-P\-D\-B()} 
\end{DoxyItemize}

Definition in file \hyperlink{_resol_p_d_b_8c_source}{Resol\-P\-D\-B.\-c}.



\subsection{Macro Definition Documentation}
\hypertarget{_resol_p_d_b_8c_a0c8dad16ba61ded55d3f302a616c0ced}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!M\-A\-X\-B\-U\-F\-F@{M\-A\-X\-B\-U\-F\-F}}
\index{M\-A\-X\-B\-U\-F\-F@{M\-A\-X\-B\-U\-F\-F}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{M\-A\-X\-B\-U\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X\-B\-U\-F\-F~160}}\label{_resol_p_d_b_8c_a0c8dad16ba61ded55d3f302a616c0ced}


Definition at line 121 of file Resol\-P\-D\-B.\-c.



\subsection{Function Documentation}
\hypertarget{_resol_p_d_b_8c_a09f6999081df2204ee322f785319282e}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Get\-Exptl\-Old@{bl\-Get\-Exptl\-Old}}
\index{bl\-Get\-Exptl\-Old@{bl\-Get\-Exptl\-Old}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Get\-Exptl\-Old}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Get\-Exptl\-Old (
\begin{DoxyParamCaption}
\item[{F\-I\-L\-E $\ast$}]{fp, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{resolution, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{R\-Factor, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{Free\-R, }
\item[{int $\ast$}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_a09f6999081df2204ee322f785319282e}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$fp} & P\-D\-B file pointer \\
\hline
\mbox{\tt out}  & {\em $\ast$resolution} & The resolution (0.\-0 if not applicable) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-R\-Factor} & The R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Free\-R} & The Free R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Struc\-Type} & Structure type\-: S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-X\-T\-A\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-M\-R S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-O\-D\-E\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-N\-K\-N\-O\-W\-N \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\-R\-U\-E if resolution found (even if not applicable)
\end{DoxyReturn}
This routine attempts to obtain resolution and R-\/factor information out of a P\-D\-B file. It returns T\-R\-U\-E or F\-A\-L\-S\-E to indicate whether valid information was found. Resolution-\/not-\/applicable structures then have the resolution set to zero.

N.\-B. The resolution information returned by the routine is reliable; the R-\/factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-\/factor to be the first number after the words `\-R-\/value' (or one of the other keys -\/ see the case statement in the code for the valid keywords). Thus we cannot handle records of the form\-: T\-H\-E R-\/\-V\-A\-L\-U\-E F\-O\-R 7142 R\-E\-F\-L\-E\-C\-T\-I\-O\-N\-S B\-E\-T\-W\-E\-E\-N 10.\-0 A\-N\-D 1.\-97 A\-N\-G\-S\-T\-R\-O\-M\-S R\-E\-F\-I\-N\-E\-M\-E\-N\-T C\-Y\-C\-L\-E 73 I\-S 0.\-254. as appears in entries such as 1\-L\-Z\-T. Here, the first number is the number of reflections. There is thus a kludge which sets the R-\/factor to zero if it was read as greater than 0.\-5 to avoid this situation. In these cases, we lose the R-\/factor information. This occurs in approx 3.\-5\% of the 1\-X\-X\-X P\-D\-B entries.


\begin{DoxyItemize}
\item 25.\-02.\-94 Original By\-: A\-C\-R\-M
\item 28.\-02.\-94 Added \char`\"{} R = \char`\"{} and check that V\-A\-L\-U\-E wasn't B-\/\-V\-A\-L\-U\-E
\item 17.\-07.\-96 Added check for E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E \-: T\-H\-E\-O\-R\-E\-T\-I\-C\-A\-L M\-O\-D\-E\-L Also fixed bug in searching R\-E\-M\-A\-R\-K record
\item 27.\-06.\-97 Added handing of R\-E\-S\-O\-L\-U\-T\-I\-O\-N records which point you to another record for the experiment type. Fixed some calls to Find\-Next\-Number() which were checking an 80 character width Fixed E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E to look for N\-M\-R as well Looks for E\-X\-P\-D\-T\-A N\-M\-R record
\item 23.\-03.\-98 Added check that R\-E\-S\-O\-L\-U\-T\-I\-O\-N record is in a R\-E\-M\-A\-R\-K 2
\item 08.\-03.\-99 Renamed to Get\-Exptl() from Get\-Resol\-P\-D\-B() and added Free\-R parameter. Get\-Resol\-P\-D\-B() is now a wrapper to this routine. Added additional pass which looks for the structured R\-E\-M\-A\-R\-K 3 records
\item 28.\-04.\-99 Initialise Find\-Ref\-Record et al. to zero
\item 18.\-06.\-99 Added other strings to the valid structured block for pass 0 Added check for -\/ve R-\/factor
\item 08.\-09.\-99 Now takes the first F\-R\-E\-E R-\/factor followed by 17 spaces rather than the last
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 666 of file Resol\-P\-D\-B.\-c.

\hypertarget{_resol_p_d_b_8c_a80f6538fb3e9116b484a44993c62a1a6}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Get\-Exptl\-P\-D\-B@{bl\-Get\-Exptl\-P\-D\-B}}
\index{bl\-Get\-Exptl\-P\-D\-B@{bl\-Get\-Exptl\-P\-D\-B}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Get\-Exptl\-P\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Get\-Exptl\-P\-D\-B (
\begin{DoxyParamCaption}
\item[{F\-I\-L\-E $\ast$}]{fp, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{resolution, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{R\-Factor, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{Free\-R, }
\item[{int $\ast$}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_a80f6538fb3e9116b484a44993c62a1a6}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$fp} & P\-D\-B file pointer \\
\hline
\mbox{\tt out}  & {\em $\ast$resolution} & The resolution (0.\-0 if not applicable) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-R\-Factor} & The R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Free\-R} & The Free R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Struc\-Type} & Structure type\-: S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-X\-T\-A\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-M\-R S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-O\-D\-E\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-N\-K\-N\-O\-W\-N \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\-R\-U\-E if resolution found or valid structure type found
\end{DoxyReturn}
This routine attempts to obtain resolution and R-\/factor information out of a P\-D\-B file. It returns T\-R\-U\-E or F\-A\-L\-S\-E to indicate whether valid information was found. Resolution-\/not-\/applicable structures then have the resolution set to zero.


\begin{DoxyItemize}
\item 12.\-12.\-11 Original By\-: A\-C\-R\-M New implementation for remediated P\-D\-B files. The old version is available as Get\-Exptl\-Old() which handles old format files. N\-O\-T\-E If multiple methods specified in E\-X\-P\-D\-T\-A record, only the first is used If multiple R-\/factors are provided in different sections, then the first one is returned.
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P
\item 02.\-03.\-15 Moved the actual work into Read\-Data() By\-: A\-C\-R\-M Renamed from bl\-Get\-Exptl() 
\end{DoxyItemize}

Definition at line 289 of file Resol\-P\-D\-B.\-c.

\hypertarget{_resol_p_d_b_8c_ae30274ef986cfdd010792451a61ae96b}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Get\-Exptl\-Whole\-P\-D\-B@{bl\-Get\-Exptl\-Whole\-P\-D\-B}}
\index{bl\-Get\-Exptl\-Whole\-P\-D\-B@{bl\-Get\-Exptl\-Whole\-P\-D\-B}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Get\-Exptl\-Whole\-P\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Get\-Exptl\-Whole\-P\-D\-B (
\begin{DoxyParamCaption}
\item[{{\bf W\-H\-O\-L\-E\-P\-D\-B} $\ast$}]{wpdb, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{resolution, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{R\-Factor, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{Free\-R, }
\item[{int $\ast$}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_ae30274ef986cfdd010792451a61ae96b}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$wpdb} & W\-H\-O\-L\-E\-P\-D\-B structure pointer \\
\hline
\mbox{\tt out}  & {\em $\ast$resolution} & The resolution (0.\-0 if not applicable) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-R\-Factor} & The R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Free\-R} & The Free R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Struc\-Type} & Structure type\-: S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-X\-T\-A\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-M\-R S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-O\-D\-E\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-N\-K\-N\-O\-W\-N \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\-R\-U\-E if resolution found or valid structure type found
\end{DoxyReturn}
This routine attempts to obtain resolution and R-\/factor information out of a P\-D\-B file. It returns T\-R\-U\-E or F\-A\-L\-S\-E to indicate whether valid information was found. Resolution-\/not-\/applicable structures then have the resolution set to zero.


\begin{DoxyItemize}
\item 02.\-03.\-15 Original based on \hyperlink{pdb_8h_a80f6538fb3e9116b484a44993c62a1a6}{bl\-Get\-Exptl\-P\-D\-B()} By\-: A\-C\-R\-M 
\end{DoxyItemize}

Definition at line 350 of file Resol\-P\-D\-B.\-c.

\hypertarget{_resol_p_d_b_8c_a35c8f98e52940966707d8004ed8a5826}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Get\-Resol\-P\-D\-B@{bl\-Get\-Resol\-P\-D\-B}}
\index{bl\-Get\-Resol\-P\-D\-B@{bl\-Get\-Resol\-P\-D\-B}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Get\-Resol\-P\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Get\-Resol\-P\-D\-B (
\begin{DoxyParamCaption}
\item[{F\-I\-L\-E $\ast$}]{fp, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{resolution, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{R\-Factor, }
\item[{int $\ast$}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_a35c8f98e52940966707d8004ed8a5826}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$fp} & P\-D\-B file pointer \\
\hline
\mbox{\tt out}  & {\em $\ast$resolution} & The resolution (0.\-0 if not applicable) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-R\-Factor} & The R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Struc\-Type} & Structure type\-: S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-X\-T\-A\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-M\-R S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-O\-D\-E\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-N\-K\-N\-O\-W\-N \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\-R\-U\-E if resolution found (even if not applicable)
\end{DoxyReturn}
This routine attempts to obtain resolution and R-\/factor information out of a P\-D\-B file. It returns T\-R\-U\-E or F\-A\-L\-S\-E to indicate whether valid information was found. Resolution-\/not-\/applicable structures then have the resolution set to zero.

N.\-B. The resolution information returned by the routine is reliable; the R-\/factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-\/factor to be the first number after the words `\-R-\/value' (or one of the other keys -\/ see the case statement in the code for the valid keywords). Thus we cannot handle records of the form\-: T\-H\-E R-\/\-V\-A\-L\-U\-E F\-O\-R 7142 R\-E\-F\-L\-E\-C\-T\-I\-O\-N\-S B\-E\-T\-W\-E\-E\-N 10.\-0 A\-N\-D 1.\-97 A\-N\-G\-S\-T\-R\-O\-M\-S R\-E\-F\-I\-N\-E\-M\-E\-N\-T C\-Y\-C\-L\-E 73 I\-S 0.\-254. as appears in entries such as 1\-L\-Z\-T. Here, the first number is the number of reflections. There is thus a kludge which sets the R-\/factor to zero if it was read as greater than 0.\-5 to avoid this situation. In these cases, we lose the R-\/factor information. This occurs in approx 3.\-5\% of the 1\-X\-X\-X P\-D\-B entries.


\begin{DoxyItemize}
\item 25.\-02.\-94 Original By\-: A\-C\-R\-M
\item 28.\-02.\-94 Added \char`\"{} R = \char`\"{} and check that V\-A\-L\-U\-E wasn't B-\/\-V\-A\-L\-U\-E
\item 17.\-07.\-96 Added check for E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E \-: T\-H\-E\-O\-R\-E\-T\-I\-C\-A\-L M\-O\-D\-E\-L Also fixed bug in searching R\-E\-M\-A\-R\-K record
\item 27.\-06.\-97 Added handing of R\-E\-S\-O\-L\-U\-T\-I\-O\-N records which point you to another record for the experiment type. Fixed some calls to Find\-Next\-Number() which were checking an 80 character width Fixed E\-X\-P\-E\-R\-I\-M\-E\-N\-T T\-Y\-P\-E to look for N\-M\-R as well Looks for E\-X\-P\-D\-T\-A N\-M\-R record
\item 23.\-03.\-98 Added check that R\-E\-S\-O\-L\-U\-T\-I\-O\-N record is in a R\-E\-M\-A\-R\-K 2
\item 08.\-02.\-99 Now a wrapper to Get\-Exptl() which also returns Free\-R
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 193 of file Resol\-P\-D\-B.\-c.

\hypertarget{_resol_p_d_b_8c_a4d5b4d6154f9efed0b1bf00dcb5aa16b}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Get\-Resol\-Whole\-P\-D\-B@{bl\-Get\-Resol\-Whole\-P\-D\-B}}
\index{bl\-Get\-Resol\-Whole\-P\-D\-B@{bl\-Get\-Resol\-Whole\-P\-D\-B}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Get\-Resol\-Whole\-P\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\-O\-O\-L} bl\-Get\-Resol\-Whole\-P\-D\-B (
\begin{DoxyParamCaption}
\item[{{\bf W\-H\-O\-L\-E\-P\-D\-B} $\ast$}]{wpdb, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{resolution, }
\item[{{\bf R\-E\-A\-L} $\ast$}]{R\-Factor, }
\item[{int $\ast$}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_a4d5b4d6154f9efed0b1bf00dcb5aa16b}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$wpdb} & W\-H\-O\-L\-E\-P\-D\-B structure pointer \\
\hline
\mbox{\tt out}  & {\em $\ast$resolution} & The resolution (0.\-0 if not applicable) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-R\-Factor} & The R-\/factor (0.\-0 if not found) \\
\hline
\mbox{\tt out}  & {\em $\ast$\-Struc\-Type} & Structure type\-: S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-X\-T\-A\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-N\-M\-R S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-M\-O\-D\-E\-L S\-T\-R\-U\-C\-T\-U\-R\-E\-\_\-\-T\-Y\-P\-E\-\_\-\-U\-N\-K\-N\-O\-W\-N \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\-R\-U\-E if resolution found or valid structure type found
\end{DoxyReturn}
This routine attempts to obtain resolution and R-\/factor information out of a W\-H\-O\-L\-E\-P\-D\-B structure. It returns T\-R\-U\-E or F\-A\-L\-S\-E to indicate whether valid information was found. Resolution-\/not-\/applicable structures then have the resolution set to zero.

N.\-B. The resolution information returned by the routine is reliable; the R-\/factor information is stored in so many forms that it is difficult to read without some form of natural language parsing, but we manage to handle most situations. The routine assumes the R-\/factor to be the first number after the words `\-R-\/value' (or one of the other keys -\/ see the case statement in the code for the valid keywords). Thus we cannot handle records of the form\-: T\-H\-E R-\/\-V\-A\-L\-U\-E F\-O\-R 7142 R\-E\-F\-L\-E\-C\-T\-I\-O\-N\-S B\-E\-T\-W\-E\-E\-N 10.\-0 A\-N\-D 1.\-97 A\-N\-G\-S\-T\-R\-O\-M\-S R\-E\-F\-I\-N\-E\-M\-E\-N\-T C\-Y\-C\-L\-E 73 I\-S 0.\-254. as appears in entries such as 1\-L\-Z\-T. Here, the first number is the number of reflections. There is thus a kludge which sets the R-\/factor to zero if it was read as greater than 0.\-5 to avoid this situation. In these cases, we lose the R-\/factor information. This occurs in approx 3.\-5\% of the 1\-X\-X\-X P\-D\-B entries.


\begin{DoxyItemize}
\item 02.\-03.\-15 Original By\-: A\-C\-R\-M 
\end{DoxyItemize}

Definition at line 244 of file Resol\-P\-D\-B.\-c.

\hypertarget{_resol_p_d_b_8c_a570868c653dcba07ecddf06b1a15c4b2}{\index{Resol\-P\-D\-B.\-c@{Resol\-P\-D\-B.\-c}!bl\-Report\-Structure\-Type@{bl\-Report\-Structure\-Type}}
\index{bl\-Report\-Structure\-Type@{bl\-Report\-Structure\-Type}!ResolPDB.c@{Resol\-P\-D\-B.\-c}}
\subsubsection[{bl\-Report\-Structure\-Type}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ bl\-Report\-Structure\-Type (
\begin{DoxyParamCaption}
\item[{int}]{Struc\-Type}
\end{DoxyParamCaption}
)}}\label{_resol_p_d_b_8c_a570868c653dcba07ecddf06b1a15c4b2}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Struc\-Type} & Stucture type returned by Resol\-P\-D\-B() \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Stucture type description.
\end{DoxyReturn}
Returns structure description.

\begin{DoxyVerb}  STRUCTURE_TYPE_UNKNOWN     Unknown
  STRUCTURE_TYPE_XTAL        X-ray crystal structure
  STRUCTURE_TYPE_NMR         NMR
  STRUCTURE_TYPE_MODEL       Model
  STRUCTURE_TYPE_ELECTDIFF   Electron Diffraction
  STRUCTURE_TYPE_FIBER       Fiber Diffraction
  STRUCTURE_TYPE_SSNMR       Solid State NMR
  STRUCTURE_TYPE_NEUTRON     Neutron Scattering
  STRUCTURE_TYPE_EM          Electron Miscroscopy
  STRUCTURE_TYPE_SOLSCAT     Solution Scattering
  STRUCTURE_TYPE_IR          Infra-red Spectroscopy
  STRUCTURE_TYPE_POWDER      Powder Diffraction
  STRUCTURE_TYPE_FRET        Fluorescence Transfer
\end{DoxyVerb}



\begin{DoxyItemize}
\item 07.\-07.\-14 Use bl prefix for functions By\-: C\-T\-P 
\end{DoxyItemize}

Definition at line 410 of file Resol\-P\-D\-B.\-c.

